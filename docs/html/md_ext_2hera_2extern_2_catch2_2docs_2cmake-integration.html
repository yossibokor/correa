<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Correa: cmake-integration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Correa<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">C++ library with Python bindings to analyse the shape                             of simple closed curves in R^2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">cmake-integration </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="top"></a> </p>
<h1><a class="anchor" id="autotoc_md41"></a>
CMake integration</h1>
<p><b>Contents</b><br  />
 CMake targets<br  />
 Automatic test registration<br  />
 CMake project options<br  />
 Installing Catch2 from git repository<br  />
 Installing Catch2 from vcpkg<br  />
</p>
<p>Because we use CMake to build Catch2, we also provide a couple of integration points for our users.</p>
<p>1) Catch2 exports a (namespaced) CMake target 2) Catch2's repository contains CMake scripts for automatic registration of <code>TEST_CASE</code>s in CTest</p>
<h2><a class="anchor" id="autotoc_md42"></a>
CMake targets</h2>
<p>Catch2's CMake build exports two targets, <code>Catch2::Catch2</code>, and <code>Catch2::Catch2WithMain</code>. If you do not need custom <code>main</code> function, you should be using the latter (and only the latter). Linking against it will add the proper include paths and link your target together with 2 static libraries that implement Catch2 and its main respectively. If you need custom <code>main</code>, you should link only against <code>Catch2::Catch2</code>.</p>
<p>This means that if Catch2 has been installed on the system, it should be enough to do </p><div class="fragment"><div class="line">find_package(Catch2 3 REQUIRED)</div>
<div class="line"># These tests can use the Catch2-provided main</div>
<div class="line">add_executable(tests test.cpp)</div>
<div class="line">target_link_libraries(tests PRIVATE Catch2::Catch2WithMain)</div>
<div class="line"> </div>
<div class="line"># These tests need their own main</div>
<div class="line">add_executable(custom-main-tests test.cpp test-main.cpp)</div>
<div class="line">target_link_libraries(custom-main-tests PRIVATE Catch2::Catch2)</div>
</div><!-- fragment --><p>These targets are also provided when Catch2 is used as a subdirectory. Assuming Catch2 has been cloned to <code>lib/Catch2</code>, you only need to replace the <code>find_package</code> call with <code>add_subdirectory(lib/Catch2)</code> and the snippet above still works.</p>
<p>Another possibility is to use <a href="https://cmake.org/cmake/help/latest/module/FetchContent.html">FetchContent</a>: </p><div class="fragment"><div class="line">Include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  Catch2</div>
<div class="line">  GIT_REPOSITORY https://github.com/catchorg/Catch2.git</div>
<div class="line">  GIT_TAG        v3.0.0-preview3</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">FetchContent_MakeAvailable(Catch2)</div>
<div class="line"> </div>
<div class="line">add_executable(tests test.cpp)</div>
<div class="line">target_link_libraries(tests PRIVATE Catch2::Catch2WithMain)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Automatic test registration</h2>
<p>Catch2's repository also contains two CMake scripts that help users with automatically registering their <code>TEST_CASE</code>s with CTest. They can be found in the <code>extras</code> folder, and are</p>
<p>1) <code>Catch.cmake</code> (and its dependency <code>CatchAddTests.cmake</code>) 2) <code>ParseAndAddCatchTests.cmake</code> (deprecated)</p>
<p>If Catch2 has been installed in system, both of these can be used after doing <code>find_package(Catch2 REQUIRED)</code>. Otherwise you need to add them to your CMake module path.</p>
<h3><a class="anchor" id="autotoc_md44"></a>
&lt;tt&gt;Catch.cmake&lt;/tt&gt; and &lt;tt&gt;CatchAddTests.cmake&lt;/tt&gt;</h3>
<p><code>Catch.cmake</code> provides function <code>catch_discover_tests</code> to get tests from a target. This function works by running the resulting executable with <code>--list-test-names-only</code> flag, and then parsing the output to find all existing tests.</p>
<h4><a class="anchor" id="autotoc_md45"></a>
Usage</h4>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.5)</div>
<div class="line"> </div>
<div class="line">project(baz LANGUAGES CXX VERSION 0.0.1)</div>
<div class="line"> </div>
<div class="line">find_package(Catch2 REQUIRED)</div>
<div class="line">add_executable(foo test.cpp)</div>
<div class="line">target_link_libraries(foo PRIVATE Catch2::Catch2)</div>
<div class="line"> </div>
<div class="line">include(CTest)</div>
<div class="line">include(Catch)</div>
<div class="line">catch_discover_tests(foo)</div>
</div><!-- fragment --><p>When using <code>FetchContent</code>, <code>include(Catch)</code> will fail unless <code>CMAKE_MODULE_PATH</code> is explicitly updated to include the extras directory.</p>
<div class="fragment"><div class="line"># ... FetchContent ...</div>
<div class="line">#</div>
<div class="line">list(APPEND CMAKE_MODULE_PATH ${catch2_SOURCE_DIR}/extras)</div>
<div class="line">include(CTest)</div>
<div class="line">include(Catch)</div>
<div class="line">catch_discover_tests()</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md46"></a>
Customization</h4>
<p><code>catch_discover_tests</code> can be given several extra argumets: </p><div class="fragment"><div class="line">catch_discover_tests(target</div>
<div class="line">                     [TEST_SPEC arg1...]</div>
<div class="line">                     [EXTRA_ARGS arg1...]</div>
<div class="line">                     [WORKING_DIRECTORY dir]</div>
<div class="line">                     [TEST_PREFIX prefix]</div>
<div class="line">                     [TEST_SUFFIX suffix]</div>
<div class="line">                     [PROPERTIES name1 value1...]</div>
<div class="line">                     [TEST_LIST var]</div>
<div class="line">                     [REPORTER reporter]</div>
<div class="line">                     [OUTPUT_DIR dir]</div>
<div class="line">                     [OUTPUT_PREFIX prefix]</div>
<div class="line">                     [OUTPUT_SUFFIX suffix]</div>
<div class="line">)</div>
</div><!-- fragment --><ul>
<li><code>TEST_SPEC arg1...</code></li>
</ul>
<p>Specifies test cases, wildcarded test cases, tags and tag expressions to pass to the Catch executable alongside the <code>--list-test-names-only</code> flag.</p>
<ul>
<li><code>EXTRA_ARGS arg1...</code></li>
</ul>
<p>Any extra arguments to pass on the command line to each test case.</p>
<ul>
<li><code>WORKING_DIRECTORY dir</code></li>
</ul>
<p>Specifies the directory in which to run the discovered test cases. If this option is not provided, the current binary directory is used.</p>
<ul>
<li><code>TEST_PREFIX prefix</code></li>
</ul>
<p>Specifies a <em>prefix</em> to be added to the name of each discovered test case. This can be useful when the same test executable is being used in multiple calls to <code>catch_discover_tests()</code>, with different <code>TEST_SPEC</code> or <code>EXTRA_ARGS</code>.</p>
<ul>
<li><code>TEST_SUFFIX suffix</code></li>
</ul>
<p>Same as <code>TEST_PREFIX</code>, except it specific the <em>suffix</em> for the test names. Both <code>TEST_PREFIX</code> and <code>TEST_SUFFIX</code> can be specified at the same time.</p>
<ul>
<li><code>PROPERTIES name1 value1...</code></li>
</ul>
<p>Specifies additional properties to be set on all tests discovered by this invocation of <code>catch_discover_tests</code>.</p>
<ul>
<li><code>TEST_LIST var</code></li>
</ul>
<p>Make the list of tests available in the variable <code>var</code>, rather than the default <code>&lt;target&gt;_TESTS</code>. This can be useful when the same test executable is being used in multiple calls to <code>catch_discover_tests()</code>. Note that this variable is only available in CTest.</p>
<ul>
<li><code>REPORTER reporter</code></li>
</ul>
<p>Use the specified reporter when running the test case. The reporter will be passed to the test runner as <code>--reporter reporter</code>.</p>
<ul>
<li><code>OUTPUT_DIR dir</code></li>
</ul>
<p>If specified, the parameter is passed along as <code>--out dir/&lt;test_name&gt;</code> to test executable. The actual file name is the same as the test name. This should be used instead of <code>EXTRA_ARGS --out foo</code> to avoid race conditions writing the result output when using parallel test execution.</p>
<ul>
<li><code>OUTPUT_PREFIX prefix</code></li>
</ul>
<p>May be used in conjunction with <code>OUTPUT_DIR</code>. If specified, <code>prefix</code> is added to each output file name, like so <code>--out dir/prefix&lt;test_name&gt;</code>.</p>
<ul>
<li><code>OUTPUT_SUFFIX suffix</code></li>
</ul>
<p>May be used in conjunction with <code>OUTPUT_DIR</code>. If specified, <code>suffix</code> is added to each output file name, like so <code>--out dir/&lt;test_name&gt;suffix</code>. This can be used to add a file extension to the output file name e.g. ".xml".</p>
<h3><a class="anchor" id="autotoc_md47"></a>
&lt;tt&gt;ParseAndAddCatchTests.cmake&lt;/tt&gt;</h3>
<p>⚠ This script is <a href="https://github.com/catchorg/Catch2/pull/2120">deprecated</a> in Catch2 2.13.4 and superseded by the above approach using <code>catch_discover_tests</code>. See <a href="https://github.com/catchorg/Catch2/issues/2092">#2092</a> for details.</p>
<p><code>ParseAndAddCatchTests</code> works by parsing all implementation files associated with the provided target, and registering them via CTest's <code>add_test</code>. This approach has some limitations, such as the fact that commented-out tests will be registered anyway. More serious, only a subset of the assertion macros currently available in Catch can be detected by this script and tests with any macros that cannot be parsed are <em>silently ignored</em>.</p>
<h4><a class="anchor" id="autotoc_md48"></a>
Usage</h4>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.5)</div>
<div class="line"> </div>
<div class="line">project(baz LANGUAGES CXX VERSION 0.0.1)</div>
<div class="line"> </div>
<div class="line">find_package(Catch2 REQUIRED)</div>
<div class="line">add_executable(foo test.cpp)</div>
<div class="line">target_link_libraries(foo PRIVATE Catch2::Catch2)</div>
<div class="line"> </div>
<div class="line">include(CTest)</div>
<div class="line">include(ParseAndAddCatchTests)</div>
<div class="line">ParseAndAddCatchTests(foo)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md49"></a>
Customization</h4>
<p><code>ParseAndAddCatchTests</code> provides some customization points:</p><ul>
<li><code>PARSE_CATCH_TESTS_VERBOSE</code> &ndash; When <code>ON</code>, the script prints debug messages. Defaults to <code>OFF</code>.</li>
<li><code>PARSE_CATCH_TESTS_NO_HIDDEN_TESTS</code> &ndash; When <code>ON</code>, hidden tests (tests tagged with either of <code>[.]</code> or <code>[.foo]</code>) will not be registered. Defaults to <code>OFF</code>.</li>
<li><code>PARSE_CATCH_TESTS_ADD_FIXTURE_IN_TEST_NAME</code> &ndash; When <code>ON</code>, adds fixture class name to the test name in CTest. Defaults to <code>ON</code>.</li>
<li><code>PARSE_CATCH_TESTS_ADD_TARGET_IN_TEST_NAME</code> &ndash; When <code>ON</code>, adds target name to the test name in CTest. Defaults to <code>ON</code>.</li>
<li><code>PARSE_CATCH_TESTS_ADD_TO_CONFIGURE_DEPENDS</code> &ndash; When <code>ON</code>, adds test file to <code>CMAKE_CONFIGURE_DEPENDS</code>. This means that the CMake configuration step will be re-ran when the test files change, letting new tests be automatically discovered. Defaults to <code>OFF</code>.</li>
</ul>
<p>Optionally, one can specify a launching command to run tests by setting the variable <code>OptionalCatchTestLauncher</code> before calling <code>ParseAndAddCatchTests</code>. For instance to run some tests using <code>MPI</code> and other sequentially, one can write </p><div class="fragment"><div class="line">set(OptionalCatchTestLauncher ${MPIEXEC} ${MPIEXEC_NUMPROC_FLAG} ${NUMPROC})</div>
<div class="line">ParseAndAddCatchTests(mpi_foo)</div>
<div class="line">unset(OptionalCatchTestLauncher)</div>
<div class="line">ParseAndAddCatchTests(bar)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md50"></a>
CMake project options</h2>
<p>Catch2's CMake project also provides some options for other projects that consume it. These are:</p>
<ul>
<li><code>BUILD_TESTING</code> &ndash; When <code>ON</code> and the project is not used as a subproject, Catch2's test binary will be built. Defaults to <code>ON</code>.</li>
<li><code>CATCH_INSTALL_DOCS</code> &ndash; When <code>ON</code>, Catch2's documentation will be included in the installation. Defaults to <code>ON</code>.</li>
<li><code>CATCH_INSTALL_EXTRAS</code> &ndash; When <code>ON</code>, Catch2's extras folder (the CMake scripts mentioned above, debugger helpers) will be included in the installation. Defaults to <code>ON</code>.</li>
<li><code>CATCH_DEVELOPMENT_BUILD</code> &ndash; When <code>ON</code>, configures the build for development of Catch2. This means enabling test projects, warnings and so on. Defaults to <code>OFF</code>.</li>
</ul>
<p>Enabling <code>CATCH_DEVELOPMENT_BUILD</code> also enables further configuration customization options:</p>
<ul>
<li><code>CATCH_BUILD_TESTING</code> &ndash; When <code>ON</code>, Catch2's SelfTest project will be built. Defaults to <code>ON</code>. Note that Catch2 also obeys <code>BUILD_TESTING</code> CMake variable, so <em>both</em> of them need to be <code>ON</code> for the SelfTest to be built, and either of them can be set to <code>OFF</code> to disable building SelfTest.</li>
<li><code>CATCH_BUILD_EXAMPLES</code> &ndash; When <code>ON</code>, Catch2's usage examples will be built. Defaults to <code>OFF</code>.</li>
<li><code>CATCH_BUILD_EXTRA_TESTS</code> &ndash; When <code>ON</code>, Catch2's extra tests will be built. Defaults to <code>OFF</code>.</li>
<li><code>CATCH_BUILD_FUZZERS</code> &ndash; When <code>ON</code>, Catch2 fuzzing entry points will be built. Defaults to <code>OFF</code>.</li>
<li><code>CATCH_ENABLE_WERROR</code> &ndash; When <code>ON</code>, adds <code>-Werror</code> or equivalent flag to the compilation. Defaults to <code>ON</code>.</li>
<li><code>CATCH_BUILD_SURROGATES</code> &ndash; When <code>ON</code>, each header in Catch2 will be compiled separately to ensure that they are self-sufficient. Defaults to <code>OFF</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md51"></a>
Installing Catch2 from git repository</h2>
<p>If you cannot install Catch2 from a package manager (e.g. Ubuntu 16.04 provides catch only in version 1.2.0) you might want to install it from the repository instead. Assuming you have enough rights, you can just install it to the default location, like so: </p><div class="fragment"><div class="line">$ git clone https://github.com/catchorg/Catch2.git</div>
<div class="line">$ cd Catch2</div>
<div class="line">$ cmake -Bbuild -H. -DBUILD_TESTING=OFF</div>
<div class="line">$ sudo cmake --build build/ --target install</div>
</div><!-- fragment --><p>If you do not have superuser rights, you will also need to specify <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_INSTALL_PREFIX.html">CMAKE_INSTALL_PREFIX</a> when configuring the build, and then modify your calls to <a href="https://cmake.org/cmake/help/latest/command/find_package.html">find_package</a> accordingly.</p>
<h2><a class="anchor" id="autotoc_md52"></a>
Installing Catch2 from vcpkg</h2>
<p>Alternatively, you can build and install Catch2 using <a href="https://github.com/microsoft/vcpkg/">vcpkg</a> dependency manager: </p><div class="fragment"><div class="line">git clone https://github.com/Microsoft/vcpkg.git</div>
<div class="line">cd vcpkg</div>
<div class="line">./bootstrap-vcpkg.sh</div>
<div class="line">./vcpkg integrate install</div>
<div class="line">./vcpkg install catch2</div>
</div><!-- fragment --><p>The catch2 port in vcpkg is kept up to date by microsoft team members and community contributors. If the version is out of date, please <a href="https://github.com/Microsoft/vcpkg">create an issue or pull request</a> on the vcpkg repository.</p>
<hr  />
<p><a href="Readme.md#top">Home</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
