\hypertarget{_frechet_8h_source}{}\doxysection{Frechet.\+h}
\label{_frechet_8h_source}\index{Frechet.h@{Frechet.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ \ \ \ Frechet.h}}
\DoxyCodeLine{00003\ \textcolor{comment}{}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ \ Authors:\ \ \ \ Patrice\ Koehl,\ Department\ of\ Computer\ Science,\ University\ of\ California,\ Davis}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Yossi\ Bokor\ Bleile,\ Department\ of\ Mathematical\ Sciences,\ University\ of\ Aalborg,\ Aalborg}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ \ \ \ Date:\ April\ 2023}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ \ \ \ Version:\ 1}}
\DoxyCodeLine{00008\ \textcolor{comment}{}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ \ This\ file\ implements\ the\ discrete\ Frechet\ distance\ for\ comparing\ two\ polygonal\ curves}}
\DoxyCodeLine{00010\ \textcolor{comment}{}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ \ Implementation\ based\ on:}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ \ \ \ Eiter,\ Thomas;\ Mannila,\ Heikki\ (1994),\ Computing\ discrete\ Fr√©chet\ distance}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ \ \ \ Tech.\ Report\ CD-\/TR\ 94/64,\ Christian\ Doppler\ Laboratory\ for\ Expert\ Systems,\ TU\ Vienna,\ Austria.}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ \ \ \ LGPL\ licensing}}
\DoxyCodeLine{00015\ \textcolor{comment}{*/}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#ifndef\ \_FRECHET\_H\_}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ \_FRECHET\_H\_}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <float.h>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00025\ \textcolor{keyword}{namespace\ }correa\ \{}
\DoxyCodeLine{00026\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ \ The\ Frechet\ class}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcorrea_1_1_frechet}{Frechet}}\ \{}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{comment}{//\ Compute\ discrete\ Frechet\ distance\ between\ 2\ curves}}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordtype}{double}\ dFD(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2);}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ Coupling\ search\ function}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{double}\ coupling(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,\ \textcolor{keywordtype}{double}\ *CA);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00045\ \textcolor{comment}{\ \ \ Frechet}}
\DoxyCodeLine{00046\ \textcolor{comment}{}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ Notes:}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ =====}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ curve1\ and\ curve2\ are\ two\ sets\ of\ points\ that\ define\ 2\ polygonal\ curves}}
\DoxyCodeLine{00050\ \textcolor{comment}{\ \ \ The\ points\ along\ the\ curves\ are\ expected\ to\ be\ in\ the\ order\ as\ they\ appear.}}
\DoxyCodeLine{00051\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00052\ \textcolor{comment}{\ \ \ Returned\ is\ the\ discrete\ Frechet\ distance,\ i.e.\ the\ coupling}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ \ \ measure,\ which\ is\ zero\ when\ curve1\ equals\ curve2\ and\ grows\ positively\ as\ the\ curves}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ become\ more\ dissimilar.}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ \ The\ L2\ norm\ is\ used\ to\ compute\ the\ distances\ between\ points\ in\ curve1\ and\ curve2.}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00058\ \textcolor{comment}{\ \ \ Explanation:}}
\DoxyCodeLine{00059\ \textcolor{comment}{\ \ \ ===========}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ The\ Frechet\ distance\ is\ a\ measure\ of\ similarity\ between\ to\ curves.}}
\DoxyCodeLine{00061\ \textcolor{comment}{\ \ \ It\ is\ defined\ as\ the\ minimum\ cord-\/length\ sufficient\ to\ join\ a\ point}}
\DoxyCodeLine{00062\ \textcolor{comment}{\ \ \ traveling\ forward\ along\ curve1\ and\ one\ traveling\ forward\ along\ curve2,\ although\ the}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ \ \ rate\ of\ travel\ for\ either\ point\ may\ not\ necessarily\ be\ uniform.}}
\DoxyCodeLine{00064\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00065\ \textcolor{comment}{\ \ \ The\ Frechet\ distance,\ is\ not\ in\ general\ computable\ for\ any\ given}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ continuous\ curves\ .\ However,\ the\ discrete\ Frechet\ Distance,\ also\ called}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ the\ coupling\ measure,\ is\ a\ metric\ that\ acts\ on\ the\ endpoints\ of}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ curves\ represented\ as\ polygonal\ chains.\ The\ magnitude\ of\ the\ coupling}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ measure\ is\ bounded\ by\ the\ continuous\ Frechet\ distance\ plus\ the\ length\ of\ the\ }}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ longest\ segment\ in\ either\ curve1\ or\ curve2.}}
\DoxyCodeLine{00071\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00072\ \textcolor{comment}{\ \ \ This\ function\ implements\ the\ algorithm\ to\ calculate\ discrete\ Frechet}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ \ \ distance\ outlined\ table\ 1\ in:}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ T.\ Eiter\ and\ H.\ Mannila.\ Computing\ discrete\ Frechet\ distance.\ Technical}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ \ \ Report\ 94/64,\ Christian\ Doppler\ Laboratory,\ Vienna\ University\ of}}
\DoxyCodeLine{00076\ \textcolor{comment}{\ \ \ Technology,\ 1994.}}
\DoxyCodeLine{00077\ \textcolor{comment}{}}
\DoxyCodeLine{00078\ \textcolor{comment}{\ \ \ It\ loosely\ follows\ a\ matlab\ implementation:}}
\DoxyCodeLine{00079\ \textcolor{comment}{\ \ \ Zachary\ Danziger\ (2021).\ Discrete\ Frechet\ Distance\ }}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ (https://www.mathworks.com/matlabcentral/fileexchange/31922-\/discrete-\/frechet-\/distance),\ }}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ MATLAB\ Central\ File\ Exchange.\ Retrieved\ October\ 15,\ 2021.}}
\DoxyCodeLine{00082\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{double}\ Frechet::dFD(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2)}
\DoxyCodeLine{00086\ \ \ \{}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ Number\ of\ points\ in\ the\ two\ curves}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{int}\ n1\ =\ curve1.vertices.size();}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{int}\ n2\ =\ curve2.vertices.size();}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordtype}{int}\ n1n2\ =\ n1*n2;}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{//\ Initialize\ a\ matrix\ CA\ of\ size\ n1\ x\ n2,\ with\ all\ -\/1}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{double}\ *CA\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n1*n2];}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n1n2;\ i++)\ CA[i]\ =\ -\/1;}
\DoxyCodeLine{00098\ \ \ \ \ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{//\ The\ discrete\ Frechet\ distance\ is\ the\ coupling\ for\ the\ last\ points\ in\ curve1\ and\ curve2}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{double}\ d\ =\ coupling(curve1,\ curve2,\ n1-\/1,\ n2-\/1,\ CA);\ \ \ \ }
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{return}\ d;}
\DoxyCodeLine{00103\ \ \ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ Coupling\ search\ function}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ Note:\ this\ function\ is\ recursive}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{double}\ Frechet::coupling(Polygon\&\ curve1,\ Polygon\&\ curve2,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,\ \textcolor{keywordtype}{double}\ *CA)}
\DoxyCodeLine{00111\ \ \ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{int}\ n1\ =\ curve1.vertices.size();}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{double}\ val;}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}(CA[i+j*n1]\ >\ -\/1\ )\ \textcolor{keywordflow}{return}\ CA[i+j*n1];}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (i==0\ \&\&\ j\ ==\ 0)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ CA[i+j*n1]\ =\ (curve1.vertices[0].position\ -\/curve2.vertices[0].position).norm();}
\DoxyCodeLine{00118\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i>0\ \&\&\ j\ ==\ 0)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ CA[i+j*n1]\ =\ std::max(\ coupling(curve1,\ curve2,\ i-\/1,\ 0,\ CA),\ (curve1.vertices[i].position\ -\/curve2.vertices[0].position).norm());}
\DoxyCodeLine{00120\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i==0\ \&\&\ j\ >\ 0)\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ CA[i+j*n1]\ =\ std::max(\ coupling(curve1,\ curve2,\ 0,\ j-\/1,\ CA),\ (curve1.vertices[0].position\ -\/curve2.vertices[j].position).norm());}
\DoxyCodeLine{00122\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i>0\ \&\&\ j\ >\ 0)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ val\ =\ std::min(\ coupling(curve1,\ curve2,\ i-\/1,\ j,\ CA),\ coupling(curve1,\ curve2,\ i-\/1,\ j-\/1,\ CA));}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ val\ =\ std::min(\ val,\ coupling(curve1,\ curve2,\ i,\ j-\/1,\ CA));}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ CA[i+j*n1]\ =\ std::max(val,\ (curve1.vertices[i].position\ -\/curve2.vertices[j].position).norm());}
\DoxyCodeLine{00126\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ CA[i+j*n1]\ =\ DBL\_MAX;}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{return}\ CA[i+j*n1];}
\DoxyCodeLine{00130\ \ \ \}}
\DoxyCodeLine{00131\ \}\ \textcolor{comment}{//end\ namespace\ correa}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00133\ }

\end{DoxyCode}
