\label{index_top}%
\Hypertarget{index_top}%
 \hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md41}{}\doxysection{CMake integration}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md41}
{\bfseries{Contents}}~\newline
 CMake targets~\newline
 Automatic test registration~\newline
 CMake project options~\newline
 Installing Catch2 from git repository~\newline
 Installing Catch2 from vcpkg~\newline


Because we use CMake to build Catch2, we also provide a couple of integration points for our users.

1) Catch2 exports a (namespaced) CMake target 2) Catch2\textquotesingle{}s repository contains CMake scripts for automatic registration of {\ttfamily TEST\+\_\+\+CASE}s in CTest\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md42}{}\doxysubsection{CMake targets}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md42}
Catch2\textquotesingle{}s CMake build exports two targets, {\ttfamily Catch2\+::\+Catch2}, and {\ttfamily Catch2\+::\+Catch2\+With\+Main}. If you do not need custom {\ttfamily main} function, you should be using the latter (and only the latter). Linking against it will add the proper include paths and link your target together with 2 static libraries that implement Catch2 and its main respectively. If you need custom {\ttfamily main}, you should link only against {\ttfamily Catch2\+::\+Catch2}.

This means that if Catch2 has been installed on the system, it should be enough to do 
\begin{DoxyCode}{0}
\DoxyCodeLine{find\_package(Catch2\ 3\ REQUIRED)}
\DoxyCodeLine{\#\ These\ tests\ can\ use\ the\ Catch2-\/provided\ main}
\DoxyCodeLine{add\_executable(tests\ test.cpp)}
\DoxyCodeLine{target\_link\_libraries(tests\ PRIVATE\ Catch2::Catch2WithMain)}
\DoxyCodeLine{}
\DoxyCodeLine{\#\ These\ tests\ need\ their\ own\ main}
\DoxyCodeLine{add\_executable(custom-\/main-\/tests\ test.cpp\ test-\/main.cpp)}
\DoxyCodeLine{target\_link\_libraries(custom-\/main-\/tests\ PRIVATE\ Catch2::Catch2)}

\end{DoxyCode}


These targets are also provided when Catch2 is used as a subdirectory. Assuming Catch2 has been cloned to {\ttfamily lib/\+Catch2}, you only need to replace the {\ttfamily find\+\_\+package} call with {\ttfamily add\+\_\+subdirectory(lib/\+Catch2)} and the snippet above still works.

Another possibility is to use \href{https://cmake.org/cmake/help/latest/module/FetchContent.html}{\texttt{ Fetch\+Content}}\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{Include(FetchContent)}
\DoxyCodeLine{}
\DoxyCodeLine{FetchContent\_Declare(}
\DoxyCodeLine{\ \ Catch2}
\DoxyCodeLine{\ \ GIT\_REPOSITORY\ https://github.com/catchorg/Catch2.git}
\DoxyCodeLine{\ \ GIT\_TAG\ \ \ \ \ \ \ \ v3.0.0-\/preview3}
\DoxyCodeLine{)}
\DoxyCodeLine{}
\DoxyCodeLine{FetchContent\_MakeAvailable(Catch2)}
\DoxyCodeLine{}
\DoxyCodeLine{add\_executable(tests\ test.cpp)}
\DoxyCodeLine{target\_link\_libraries(tests\ PRIVATE\ Catch2::Catch2WithMain)}

\end{DoxyCode}
\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md43}{}\doxysubsection{Automatic test registration}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md43}
Catch2\textquotesingle{}s repository also contains two CMake scripts that help users with automatically registering their {\ttfamily TEST\+\_\+\+CASE}s with CTest. They can be found in the {\ttfamily extras} folder, and are

1) {\ttfamily Catch.\+cmake} (and its dependency {\ttfamily Catch\+Add\+Tests.\+cmake}) 2) {\ttfamily Parse\+And\+Add\+Catch\+Tests.\+cmake} (deprecated)

If Catch2 has been installed in system, both of these can be used after doing {\ttfamily find\+\_\+package(\+Catch2 REQUIRED)}. Otherwise you need to add them to your CMake module path.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md44}{}\doxysubsubsection{$<$tt$>$\+Catch.\+cmake$<$/tt$>$ and $<$tt$>$\+Catch\+Add\+Tests.\+cmake$<$/tt$>$}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md44}
{\ttfamily Catch.\+cmake} provides function {\ttfamily catch\+\_\+discover\+\_\+tests} to get tests from a target. This function works by running the resulting executable with {\ttfamily -\/-\/list-\/test-\/names-\/only} flag, and then parsing the output to find all existing tests.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md45}{}\doxyparagraph{Usage}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md45}

\begin{DoxyCode}{0}
\DoxyCodeLine{cmake\_minimum\_required(VERSION\ 3.5)}
\DoxyCodeLine{}
\DoxyCodeLine{project(baz\ LANGUAGES\ CXX\ VERSION\ 0.0.1)}
\DoxyCodeLine{}
\DoxyCodeLine{find\_package(Catch2\ REQUIRED)}
\DoxyCodeLine{add\_executable(foo\ test.cpp)}
\DoxyCodeLine{target\_link\_libraries(foo\ PRIVATE\ Catch2::Catch2)}
\DoxyCodeLine{}
\DoxyCodeLine{include(CTest)}
\DoxyCodeLine{include(Catch)}
\DoxyCodeLine{catch\_discover\_tests(foo)}

\end{DoxyCode}


When using {\ttfamily Fetch\+Content}, {\ttfamily include(\+Catch)} will fail unless {\ttfamily CMAKE\+\_\+\+MODULE\+\_\+\+PATH} is explicitly updated to include the extras directory.


\begin{DoxyCode}{0}
\DoxyCodeLine{\#\ ...\ FetchContent\ ...}
\DoxyCodeLine{\#}
\DoxyCodeLine{list(APPEND\ CMAKE\_MODULE\_PATH\ \$\{catch2\_SOURCE\_DIR\}/extras)}
\DoxyCodeLine{include(CTest)}
\DoxyCodeLine{include(Catch)}
\DoxyCodeLine{catch\_discover\_tests()}

\end{DoxyCode}
\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md46}{}\doxyparagraph{Customization}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md46}
{\ttfamily catch\+\_\+discover\+\_\+tests} can be given several extra argumets\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{catch\_discover\_tests(target}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [TEST\_SPEC\ arg1...]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [EXTRA\_ARGS\ arg1...]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [WORKING\_DIRECTORY\ dir]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [TEST\_PREFIX\ prefix]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [TEST\_SUFFIX\ suffix]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [PROPERTIES\ name1\ value1...]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [TEST\_LIST\ var]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [REPORTER\ reporter]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [OUTPUT\_DIR\ dir]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [OUTPUT\_PREFIX\ prefix]}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [OUTPUT\_SUFFIX\ suffix]}
\DoxyCodeLine{)}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\ttfamily TEST\+\_\+\+SPEC arg1...}
\end{DoxyItemize}

Specifies test cases, wildcarded test cases, tags and tag expressions to pass to the Catch executable alongside the {\ttfamily -\/-\/list-\/test-\/names-\/only} flag.


\begin{DoxyItemize}
\item {\ttfamily EXTRA\+\_\+\+ARGS arg1...}
\end{DoxyItemize}

Any extra arguments to pass on the command line to each test case.


\begin{DoxyItemize}
\item {\ttfamily WORKING\+\_\+\+DIRECTORY dir}
\end{DoxyItemize}

Specifies the directory in which to run the discovered test cases. If this option is not provided, the current binary directory is used.


\begin{DoxyItemize}
\item {\ttfamily TEST\+\_\+\+PREFIX prefix}
\end{DoxyItemize}

Specifies a {\itshape prefix} to be added to the name of each discovered test case. This can be useful when the same test executable is being used in multiple calls to {\ttfamily catch\+\_\+discover\+\_\+tests()}, with different {\ttfamily TEST\+\_\+\+SPEC} or {\ttfamily EXTRA\+\_\+\+ARGS}.


\begin{DoxyItemize}
\item {\ttfamily TEST\+\_\+\+SUFFIX suffix}
\end{DoxyItemize}

Same as {\ttfamily TEST\+\_\+\+PREFIX}, except it specific the {\itshape suffix} for the test names. Both {\ttfamily TEST\+\_\+\+PREFIX} and {\ttfamily TEST\+\_\+\+SUFFIX} can be specified at the same time.


\begin{DoxyItemize}
\item {\ttfamily PROPERTIES name1 value1...}
\end{DoxyItemize}

Specifies additional properties to be set on all tests discovered by this invocation of {\ttfamily catch\+\_\+discover\+\_\+tests}.


\begin{DoxyItemize}
\item {\ttfamily TEST\+\_\+\+LIST var}
\end{DoxyItemize}

Make the list of tests available in the variable {\ttfamily var}, rather than the default {\ttfamily \texorpdfstring{$<$}{<}target\texorpdfstring{$>$}{>}\+\_\+\+TESTS}. This can be useful when the same test executable is being used in multiple calls to {\ttfamily catch\+\_\+discover\+\_\+tests()}. Note that this variable is only available in CTest.


\begin{DoxyItemize}
\item {\ttfamily REPORTER reporter}
\end{DoxyItemize}

Use the specified reporter when running the test case. The reporter will be passed to the test runner as {\ttfamily -\/-\/reporter reporter}.


\begin{DoxyItemize}
\item {\ttfamily OUTPUT\+\_\+\+DIR dir}
\end{DoxyItemize}

If specified, the parameter is passed along as {\ttfamily -\/-\/out dir/\texorpdfstring{$<$}{<}test\+\_\+name\texorpdfstring{$>$}{>}} to test executable. The actual file name is the same as the test name. This should be used instead of {\ttfamily EXTRA\+\_\+\+ARGS -\/-\/out foo} to avoid race conditions writing the result output when using parallel test execution.


\begin{DoxyItemize}
\item {\ttfamily OUTPUT\+\_\+\+PREFIX prefix}
\end{DoxyItemize}

May be used in conjunction with {\ttfamily OUTPUT\+\_\+\+DIR}. If specified, {\ttfamily prefix} is added to each output file name, like so {\ttfamily -\/-\/out dir/prefix\texorpdfstring{$<$}{<}test\+\_\+name\texorpdfstring{$>$}{>}}.


\begin{DoxyItemize}
\item {\ttfamily OUTPUT\+\_\+\+SUFFIX suffix}
\end{DoxyItemize}

May be used in conjunction with {\ttfamily OUTPUT\+\_\+\+DIR}. If specified, {\ttfamily suffix} is added to each output file name, like so {\ttfamily -\/-\/out dir/\texorpdfstring{$<$}{<}test\+\_\+name\texorpdfstring{$>$}{>}suffix}. This can be used to add a file extension to the output file name e.\+g. \char`\"{}.\+xml\char`\"{}.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md47}{}\doxysubsubsection{$<$tt$>$\+Parse\+And\+Add\+Catch\+Tests.\+cmake$<$/tt$>$}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md47}
⚠ This script is \href{https://github.com/catchorg/Catch2/pull/2120}{\texttt{ deprecated}} in Catch2 2.\+13.\+4 and superseded by the above approach using {\ttfamily catch\+\_\+discover\+\_\+tests}. See \href{https://github.com/catchorg/Catch2/issues/2092}{\texttt{ \#2092}} for details.

{\ttfamily Parse\+And\+Add\+Catch\+Tests} works by parsing all implementation files associated with the provided target, and registering them via CTest\textquotesingle{}s {\ttfamily add\+\_\+test}. This approach has some limitations, such as the fact that commented-\/out tests will be registered anyway. More serious, only a subset of the assertion macros currently available in Catch can be detected by this script and tests with any macros that cannot be parsed are {\itshape silently ignored}.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md48}{}\doxyparagraph{Usage}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md48}

\begin{DoxyCode}{0}
\DoxyCodeLine{cmake\_minimum\_required(VERSION\ 3.5)}
\DoxyCodeLine{}
\DoxyCodeLine{project(baz\ LANGUAGES\ CXX\ VERSION\ 0.0.1)}
\DoxyCodeLine{}
\DoxyCodeLine{find\_package(Catch2\ REQUIRED)}
\DoxyCodeLine{add\_executable(foo\ test.cpp)}
\DoxyCodeLine{target\_link\_libraries(foo\ PRIVATE\ Catch2::Catch2)}
\DoxyCodeLine{}
\DoxyCodeLine{include(CTest)}
\DoxyCodeLine{include(ParseAndAddCatchTests)}
\DoxyCodeLine{ParseAndAddCatchTests(foo)}

\end{DoxyCode}
\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md49}{}\doxyparagraph{Customization}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md49}
{\ttfamily Parse\+And\+Add\+Catch\+Tests} provides some customization points\+:
\begin{DoxyItemize}
\item {\ttfamily PARSE\+\_\+\+CATCH\+\_\+\+TESTS\+\_\+\+VERBOSE} -- When {\ttfamily ON}, the script prints debug messages. Defaults to {\ttfamily OFF}.
\item {\ttfamily PARSE\+\_\+\+CATCH\+\_\+\+TESTS\+\_\+\+NO\+\_\+\+HIDDEN\+\_\+\+TESTS} -- When {\ttfamily ON}, hidden tests (tests tagged with either of {\ttfamily \mbox{[}.\mbox{]}} or {\ttfamily \mbox{[}.foo\mbox{]}}) will not be registered. Defaults to {\ttfamily OFF}.
\item {\ttfamily PARSE\+\_\+\+CATCH\+\_\+\+TESTS\+\_\+\+ADD\+\_\+\+FIXTURE\+\_\+\+IN\+\_\+\+TEST\+\_\+\+NAME} -- When {\ttfamily ON}, adds fixture class name to the test name in CTest. Defaults to {\ttfamily ON}.
\item {\ttfamily PARSE\+\_\+\+CATCH\+\_\+\+TESTS\+\_\+\+ADD\+\_\+\+TARGET\+\_\+\+IN\+\_\+\+TEST\+\_\+\+NAME} -- When {\ttfamily ON}, adds target name to the test name in CTest. Defaults to {\ttfamily ON}.
\item {\ttfamily PARSE\+\_\+\+CATCH\+\_\+\+TESTS\+\_\+\+ADD\+\_\+\+TO\+\_\+\+CONFIGURE\+\_\+\+DEPENDS} -- When {\ttfamily ON}, adds test file to {\ttfamily CMAKE\+\_\+\+CONFIGURE\+\_\+\+DEPENDS}. This means that the CMake configuration step will be re-\/ran when the test files change, letting new tests be automatically discovered. Defaults to {\ttfamily OFF}.
\end{DoxyItemize}

Optionally, one can specify a launching command to run tests by setting the variable {\ttfamily Optional\+Catch\+Test\+Launcher} before calling {\ttfamily Parse\+And\+Add\+Catch\+Tests}. For instance to run some tests using {\ttfamily MPI} and other sequentially, one can write 
\begin{DoxyCode}{0}
\DoxyCodeLine{set(OptionalCatchTestLauncher\ \$\{MPIEXEC\}\ \$\{MPIEXEC\_NUMPROC\_FLAG\}\ \$\{NUMPROC\})}
\DoxyCodeLine{ParseAndAddCatchTests(mpi\_foo)}
\DoxyCodeLine{unset(OptionalCatchTestLauncher)}
\DoxyCodeLine{ParseAndAddCatchTests(bar)}

\end{DoxyCode}
\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md50}{}\doxysubsection{CMake project options}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md50}
Catch2\textquotesingle{}s CMake project also provides some options for other projects that consume it. These are\+:


\begin{DoxyItemize}
\item {\ttfamily BUILD\+\_\+\+TESTING} -- When {\ttfamily ON} and the project is not used as a subproject, Catch2\textquotesingle{}s test binary will be built. Defaults to {\ttfamily ON}.
\item {\ttfamily CATCH\+\_\+\+INSTALL\+\_\+\+DOCS} -- When {\ttfamily ON}, Catch2\textquotesingle{}s documentation will be included in the installation. Defaults to {\ttfamily ON}.
\item {\ttfamily CATCH\+\_\+\+INSTALL\+\_\+\+EXTRAS} -- When {\ttfamily ON}, Catch2\textquotesingle{}s extras folder (the CMake scripts mentioned above, debugger helpers) will be included in the installation. Defaults to {\ttfamily ON}.
\item {\ttfamily CATCH\+\_\+\+DEVELOPMENT\+\_\+\+BUILD} -- When {\ttfamily ON}, configures the build for development of Catch2. This means enabling test projects, warnings and so on. Defaults to {\ttfamily OFF}.
\end{DoxyItemize}

Enabling {\ttfamily CATCH\+\_\+\+DEVELOPMENT\+\_\+\+BUILD} also enables further configuration customization options\+:


\begin{DoxyItemize}
\item {\ttfamily CATCH\+\_\+\+BUILD\+\_\+\+TESTING} -- When {\ttfamily ON}, Catch2\textquotesingle{}s Self\+Test project will be built. Defaults to {\ttfamily ON}. Note that Catch2 also obeys {\ttfamily BUILD\+\_\+\+TESTING} CMake variable, so {\itshape both} of them need to be {\ttfamily ON} for the Self\+Test to be built, and either of them can be set to {\ttfamily OFF} to disable building Self\+Test.
\item {\ttfamily CATCH\+\_\+\+BUILD\+\_\+\+EXAMPLES} -- When {\ttfamily ON}, Catch2\textquotesingle{}s usage examples will be built. Defaults to {\ttfamily OFF}.
\item {\ttfamily CATCH\+\_\+\+BUILD\+\_\+\+EXTRA\+\_\+\+TESTS} -- When {\ttfamily ON}, Catch2\textquotesingle{}s extra tests will be built. Defaults to {\ttfamily OFF}.
\item {\ttfamily CATCH\+\_\+\+BUILD\+\_\+\+FUZZERS} -- When {\ttfamily ON}, Catch2 fuzzing entry points will be built. Defaults to {\ttfamily OFF}.
\item {\ttfamily CATCH\+\_\+\+ENABLE\+\_\+\+WERROR} -- When {\ttfamily ON}, adds {\ttfamily -\/Werror} or equivalent flag to the compilation. Defaults to {\ttfamily ON}.
\item {\ttfamily CATCH\+\_\+\+BUILD\+\_\+\+SURROGATES} -- When {\ttfamily ON}, each header in Catch2 will be compiled separately to ensure that they are self-\/sufficient. Defaults to {\ttfamily OFF}.
\end{DoxyItemize}\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md51}{}\doxysubsection{Installing Catch2 from git repository}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md51}
If you cannot install Catch2 from a package manager (e.\+g. Ubuntu 16.\+04 provides catch only in version 1.\+2.\+0) you might want to install it from the repository instead. Assuming you have enough rights, you can just install it to the default location, like so\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ git\ clone\ https://github.com/catchorg/Catch2.git}
\DoxyCodeLine{\$\ cd\ Catch2}
\DoxyCodeLine{\$\ cmake\ -\/Bbuild\ -\/H.\ -\/DBUILD\_TESTING=OFF}
\DoxyCodeLine{\$\ sudo\ cmake\ -\/-\/build\ build/\ -\/-\/target\ install}

\end{DoxyCode}


If you do not have superuser rights, you will also need to specify \href{https://cmake.org/cmake/help/latest/variable/CMAKE_INSTALL_PREFIX.html}{\texttt{ CMAKE\+\_\+\+INSTALL\+\_\+\+PREFIX}} when configuring the build, and then modify your calls to \href{https://cmake.org/cmake/help/latest/command/find_package.html}{\texttt{ find\+\_\+package}} accordingly.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md52}{}\doxysubsection{Installing Catch2 from vcpkg}\label{md_ext_2hera_2extern_2_catch2_2docs_2cmake-integration_autotoc_md52}
Alternatively, you can build and install Catch2 using \href{https://github.com/microsoft/vcpkg/}{\texttt{ vcpkg}} dependency manager\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{git\ clone\ https://github.com/Microsoft/vcpkg.git}
\DoxyCodeLine{cd\ vcpkg}
\DoxyCodeLine{./bootstrap-\/vcpkg.sh}
\DoxyCodeLine{./vcpkg\ integrate\ install}
\DoxyCodeLine{./vcpkg\ install\ catch2}

\end{DoxyCode}


The catch2 port in vcpkg is kept up to date by microsoft team members and community contributors. If the version is out of date, please \href{https://github.com/Microsoft/vcpkg}{\texttt{ create an issue or pull request}} on the vcpkg repository.

\DoxyHorRuler{0}


\href{Readme.md\#top}{\texttt{ Home}} 