\hypertarget{_ellipse_8h_source}{}\doxysection{Ellipse.\+h}
\label{_ellipse_8h_source}\index{Ellipse.h@{Ellipse.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ \ \ \ Ellipse.h}}
\DoxyCodeLine{00003\ \textcolor{comment}{}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ \ Authors:\ \ \ \ Patrice\ Koehl,\ Department\ of\ Computer\ Science,\ University\ of\ California,\ Davis}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Yossi\ Bokor\ Bleile,\ Department\ of\ Mathematical\ Sciences,\ University\ of\ Aalborg,\ Aalborg}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ \ \ \ Date:\ April\ 2023}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ \ \ \ Version:\ 1}}
\DoxyCodeLine{00008\ \textcolor{comment}{*/}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ \_ELLIPSE\_H\_}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ \_ELLIPSE\_H\_}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}Convex.h"{}}}
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }correa\ \{}
\DoxyCodeLine{00018\ Convex\ convexhull;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ \ prototypes\ for\ BLAS\ and\ LAPACK\ functions\ }}
\DoxyCodeLine{00022\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//\ BLAS1:\ copy\ one\ vector\ into\ another}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{void}\ dcopy\_(\textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *\ X,\ \textcolor{keywordtype}{int}\ *incx,\ \textcolor{keywordtype}{double}\ *\ Y,\ \textcolor{keywordtype}{int}\ *incy);}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{comment}{//\ BLAS1:\ dot\ product\ of\ two\ vectors\ \ \ \ }}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{double}\ ddot\_(\textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *\ u,\ \textcolor{keywordtype}{int}\ *\ incu,\ \textcolor{keywordtype}{double}\ *\ v,\ \textcolor{keywordtype}{int}\ *incv);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{comment}{//\ BLAS1:\ norm\ of\ a\ vector}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{double}\ dnrm2\_(\textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *\ X,\ \textcolor{keywordtype}{int}\ *incx);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{comment}{//\ BLAS1:\ Y\ <-\/\ alpha*X\ +\ Y}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ daxpy\_(\ \textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *alpha,\ \textcolor{keywordtype}{double}\ *X,\ \textcolor{keywordtype}{int}\ *incx,\ \textcolor{keywordtype}{double}\ *Y,\ \textcolor{keywordtype}{int}\ *incy);}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ BLAS1:\ X\ <-\/\ alpha*X}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ dscal\_(\textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *\ alpha,\ \textcolor{keywordtype}{double}\ *\ X,\ \textcolor{keywordtype}{int}\ *incx);}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ BLAS2:\ perform\ Y\ :=\ alpha*op(\ A\ )*\ B\ \ +\ beta*Y}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ dgemv\_(\textcolor{keywordtype}{char}\ *\ trans,\ \textcolor{keywordtype}{int}\ *\ m,\ \textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{double}\ *\ alpha,\ \textcolor{keywordtype}{double}\ *A,}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{int}\ *lda,\ \textcolor{keywordtype}{double}\ *\ X,\ \textcolor{keywordtype}{int}\ *\ incx,\ \textcolor{keywordtype}{double}\ *beta,\ \textcolor{keywordtype}{double}\ *\ Y,\ \textcolor{keywordtype}{int}\ *\ incy);}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ BLAS3:\ perform\ C\ :=\ alpha*op(\ A\ )*\ op(B)\ \ +\ beta*C}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ dgemm\_(\textcolor{keywordtype}{char}\ *\ transa,\ \textcolor{keywordtype}{char}\ *\ transb,\ \textcolor{keywordtype}{int}\ *\ m,\ \textcolor{keywordtype}{int}\ *\ n,\ \textcolor{keywordtype}{int}\ *\ k,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *\ alpha,\ \textcolor{keywordtype}{double}\ *\ A,\ \textcolor{keywordtype}{int}\ *\ lda,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ *\ B,\ \textcolor{keywordtype}{int}\ *\ ldb,\ \textcolor{keywordtype}{double}\ *\ beta,\ \textcolor{keywordtype}{double}\ *\ C,\ \textcolor{keywordtype}{int}\ *\ ldc);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ LAPACK:\ diagonalize\ a\ symmetric\ matrix}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ dgeev\_(\textcolor{keywordtype}{char}\ *\ JOBVL,\ \textcolor{keywordtype}{char}\ *\ JOBVR,\ \textcolor{keywordtype}{int}\ *N,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{int}\ *LDA,\ \textcolor{keywordtype}{double}\ *WR,}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{double}\ *WI,\ \textcolor{keywordtype}{double}\ *VL,\ \textcolor{keywordtype}{int}\ *LDVL,\ \textcolor{keywordtype}{double}\ *VR,\ \textcolor{keywordtype}{int}\ *LDVR,\ \textcolor{keywordtype}{double}\ *WORK,\ \textcolor{keywordtype}{int}\ *LWORK,\ \textcolor{keywordtype}{int}\ *INFO);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ LAPACK:\ diagonalize\ a\ general\ matrix}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{void}\ dsyevd\_(\textcolor{keywordtype}{char}\ *\ JOBZ,\ \textcolor{keywordtype}{char}\ *\ UPLO,\ \textcolor{keywordtype}{int}\ *N,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{int}\ *LDA,\ \textcolor{keywordtype}{double}\ *W,}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{double}\ *WORK,\ \textcolor{keywordtype}{int}\ *LWORK,\ \textcolor{keywordtype}{int}\ *IWORK,\ \textcolor{keywordtype}{int}\ *LIWORK,\ \textcolor{keywordtype}{int}\ *INFO);}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ LAPACK:\ LU\ algorithm}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{void}\ dgetrf\_(\textcolor{keywordtype}{int}\ *M,\ \textcolor{keywordtype}{int}\ *N,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{int}\ *LDA,\ \textcolor{keywordtype}{int}\ *IPIV,\ \textcolor{keywordtype}{int}\ *INFO);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ LAPACK:\ solve\ A*X=B\ or\ A\string^T\ *\ X\ =\ B\ based\ on\ LU\ decomposition}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{void}\ dgetrs\_(\textcolor{keywordtype}{char}\ *Trans,\ \textcolor{keywordtype}{int}\ *N,\ \textcolor{keywordtype}{int}\ *Nrhs,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{int}\ *LDA,\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{int}\ *IPIV,\ \textcolor{keywordtype}{double}\ *B,\ \textcolor{keywordtype}{int}\ *LDB,\ \textcolor{keywordtype}{int}\ *INFO);}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{void}\ dgetri\_(\textcolor{keywordtype}{int}\ *N,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{int}\ *LDA,\ \textcolor{keywordtype}{int}\ *IPIV,\ \textcolor{keywordtype}{double}\ *WORK,}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{int}\ *LWORK,\ \textcolor{keywordtype}{int}\ *INFO);}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ \ \ The\ Ellipse\ class}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcorrea_1_1_ellipse}{Ellipse}}\ \{}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//\ Compute\ major/minor\ axes\ of\ the\ largest\ enclosed\ ellipse\ in\ a\ polygon}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{void}\ EllipseMax(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ Compute\ major/minor\ axes\ of\ the\ smallest\ enclosing\ ellipse\ of\ a\ polygon}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{void}\ EllipseMin(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{comment}{//\ Compute\ major/minor\ axes\ of\ the\ least\ square\ ellipse\ of\ a\ polygon}}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{void}\ EllipseLSQ(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b);}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ largest\ enclosed\ ellipse}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{double}\ dEllipseMax(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2);}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//\ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ smallest\ enclosing\ ellipse}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{double}\ dEllipseMin(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2);}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ least\ square\ fitting\ ellipse}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{double}\ dEllipseLSQ(\mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve1,\ \mbox{\hyperlink{classcorrea_1_1_polygon}{Polygon}}\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{void}\ MaxVolEllipse(\textcolor{keywordtype}{double}\ *P,\ \textcolor{keywordtype}{int}\ N,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *c,\ \textcolor{keywordtype}{double}\ tol);}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ MinVolEllipse(\textcolor{keywordtype}{double}\ *P,\ \textcolor{keywordtype}{int}\ N,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *c,\ \textcolor{keywordtype}{double}\ tol);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordtype}{void}\ lsqEllipse(\textcolor{keywordtype}{double}\ *P,\ \textcolor{keywordtype}{int}\ N,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b);}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{void}\ Ellipse2D(\textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *c,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b,\ \textcolor{keywordtype}{double}\ *ellipse);}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordtype}{void}\ matInv2(\textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *Ainv);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00114\ \textcolor{comment}{\ \ \ MinVolEllipse}}
\DoxyCodeLine{00115\ \textcolor{comment}{}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ \ \ Finds\ the\ minimum\ volume\ enclosing\ ellipsoid\ of\ a\ set\ of\ data}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ points\ stored\ in\ a\ matrix\ P.\ The\ following\ optimization\ problem\ is\ solved:\ }}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ minimize\ \ \ \ \ \ \ log(det(A))}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ \ \ subject\ to\ \ \ \ \ (P\_i\ -\/\ c)'\ *\ A\ *\ (P\_i\ -\/\ c)\ <=\ 1}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ in\ variables\ A\ and\ c,\ where\ P\_i\ is\ the\ i-\/th\ column\ of\ the\ matrix\ P.\ }}
\DoxyCodeLine{00123\ \textcolor{comment}{\ \ \ The\ solver\ is\ based\ on\ Khachiyan\ Algorithm,\ and\ the\ final\ solution\ }}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ is\ different\ from\ the\ optimal\ value\ by\ the\ pre-\/specified\ amount\ of\ 'tol'.}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00126\ \textcolor{comment}{\ \ \ inputs:}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ P\ \ \ :\ (d\ x\ N)\ dimensional\ matrix\ containing\ N\ points\ in\ R\string^d.}}
\DoxyCodeLine{00129\ \textcolor{comment}{\ \ \ tol\ :\ error\ in\ the\ solution\ with\ respect\ to\ the\ optimal\ value.}}
\DoxyCodeLine{00130\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00131\ \textcolor{comment}{\ \ \ outputs:}}
\DoxyCodeLine{00132\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00133\ \textcolor{comment}{\ \ \ A\ \ \ \ \ \ \ \ \ \ \ \ :\ matrix\ representing\ ellipse\ (in\ fact,\ inv(A))}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ \ \ c\ \ \ \ \ \ \ \ \ \ \ \ :\ center\ of\ ellipse}}
\DoxyCodeLine{00135\ \textcolor{comment}{}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ \ \ Reference:}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ \ \ Code\ based\ on\ the\ Matlab\ package\ MinVolEllipse:}}
\DoxyCodeLine{00139\ \textcolor{comment}{}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ \ \ \ Nima\ Moshtagh\ Minimum\ Volume\ Enclosing\ Ellipsoid\ }}
\DoxyCodeLine{00141\ \textcolor{comment}{\ \ \ \ https://www.mathworks.com/matlabcentral/fileexchange/9542-\/minimum-\/volume-\/enclosing-\/ellipsoid,\ }}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ \ MATLAB\ Central\ File\ Exchange.\ }}
\DoxyCodeLine{00143\ \textcolor{comment}{}}
\DoxyCodeLine{00144\ \textcolor{comment}{\ \ \ and\ referencing\ paper:}}
\DoxyCodeLine{00145\ \textcolor{comment}{}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ \ \ \ Nima\ Moshtagh,\ "{}Minimum\ volume\ enclosing\ ellipsoid"{}}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ \ \ http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.116.7691}}
\DoxyCodeLine{00148\ \textcolor{comment}{}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \textcolor{keywordtype}{void}\ Ellipse::MinVolEllipse(\textcolor{keywordtype}{double}\ *Points,\ \textcolor{keywordtype}{int}\ Np,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *c,\ \textcolor{keywordtype}{double}\ tol)}
\DoxyCodeLine{00152\ \ \ \{}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ Build\ convex\ hull\ of\ the\ polygon\ defined\ by\ P}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ std::vector<Vector2D>\ CH;}
\DoxyCodeLine{00156\ \ \ \ \ std::vector<Vector2D>\ Poly;}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Np;\ i++)\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcorrea_1_1_vector2_d}{Vector2D}}\ v(Points[2*i],\ Points[2*i+1]);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ Poly.push\_back(v);}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ convexhull.ConvexPoly(Poly,\ CH);}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{int}\ N\ =\ CH.size()-\/1;}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordtype}{double}\ *P\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[2*N];}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ i++)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ P[2*i\ +\ 0]\ =\ CH[i][0];}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ P[2*i\ +\ 1]\ =\ CH[i][1];}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordtype}{double}\ *Q\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[(d+1)*N];}
\DoxyCodeLine{00172\ \ \ \ \ memset(Q,\ 0.0,\ (d+1)*N*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ N;\ j++)\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ dim\ =\ 0;\ dim\ <\ d;\ dim++)\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ Q[dim+(d+1)*j]\ =\ P[dim+d*j];}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ Q[d+(d+1)*j]\ =\ 1.0;}
\DoxyCodeLine{00179\ \ \ \ \ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ =========================================================================================}}
\DoxyCodeLine{00182\ \textcolor{comment}{\ \ \ \ \ \ \ Initialisation}}
\DoxyCodeLine{00183\ \textcolor{comment}{\ \ \ \ \ \ \ \ =========================================================================================\ */}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordtype}{double}\ err\ =\ 2*tol;}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordtype}{double}\ *u\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[N];}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordtype}{double}\ *new\_u\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[N];}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ i++)\ u[i]\ =\ 1./N;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordtype}{double}\ *X\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[(d+1)*(d+1)];}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{int}\ *IPIV\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[d+1];}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordtype}{int}\ lwork\ =\ 100*(d+1);}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordtype}{double}\ *WORK\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[lwork];}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordtype}{double}\ *v\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d+1];}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordtype}{double}\ *w\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d+1];}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordtype}{double}\ *M\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[N];}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordtype}{int}\ dp1\ =\ d+1;}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{int}\ dd\ =\ d*d;}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordtype}{int}\ info;}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{int}\ inc\ =\ 1;\ \textcolor{keywordtype}{int}\ one\ =\ 1;}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{char}\ NoTrans\ =\ \textcolor{charliteral}{'N'};\ \textcolor{keywordtype}{char}\ Trans\ =\ \textcolor{charliteral}{'T'};}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordtype}{double}\ alpha,\ beta;}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordtype}{double}\ dMax,\ step,\ sum;}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{int}\ idx;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ =========================================================================================}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ \ \ \ Khachiyan\ Algorithm}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ \ \ \ \ =========================================================================================\ */}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keywordflow}{while}\ (err\ >\ tol)\ \{}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ X\ =\ Q\ *\ diag(u)\ *\ Q';\ is\ a\ (d+1)x(d+1)\ matrix}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ d+1;\ i++)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ d+1;\ j++)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ =\ 0.0;}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ N;\ k++)\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ Q[i+k*(d+1)]*u[k]*Q[j+k*(d+1)];}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X[i+(d+1)*j]\ =\ sum;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ M\ =\ diag(Q'\ *\ inv(X)\ *\ Q);\ \ \%\ M\ the\ diagonal\ vector\ of\ an\ NxN\ matrix}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ dgetrf\_(\&dp1,\ \&dp1,\ X,\ \&dp1,\ IPIV,\ \&info);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ dgetri\_(\&dp1,\ X,\ \&dp1,\ IPIV,\ WORK,\ \&lwork,\ \&info);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0;}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ i++)\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ dcopy\_(\&dp1,\ \&Q[i*dp1],\ \&inc,\ v,\ \&inc);}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ dgemv\_(\&NoTrans,\ \&dp1,\ \&dp1,\ \&alpha,\ X,\ \&dp1,\ v,\ \&inc,\ \&beta,\ w,\ \&inc);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ M[i]\ =\ ddot\_(\&dp1,\ v,\ \&inc,\ w,\ \&inc);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ dMax\ =\ M[0];\ idx\ =\ 0;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ N;\ i++)\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(M[i]\ >\ dMax)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dMax\ =\ M[i];}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ idx\ =\ i;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ U\_new}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ step\ =\ (dMax\ -\/d\ -\/1)/(dp1*(dMax-\/1));}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ alpha\ =\ 1.0\ -\/\ step;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ memset(new\_u,\ 0.0,\ N*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ daxpy\_(\&N,\ \&alpha,\ u,\ \&inc,\ new\_u,\ \&inc);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ new\_u[idx]\ +=\ step;}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ error}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ alpha\ =\ -\/1.0;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ daxpy\_(\&N,\ \&alpha,\ new\_u,\ \&inc,\ u,\ \&inc);}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ err\ =\ dnrm2\_(\&N,\ u,\ \&inc);}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ U}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ dcopy\_(\&N,\ new\_u,\ \&inc,\ u,\ \&inc);}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ =========================================================================================}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ \ \ \ Find\ the\ ellipse\ equation}}
\DoxyCodeLine{00267\ \textcolor{comment}{\ \ \ \ \ \ \ \ (x-\/c)'\ *\ A\ *\ (x-\/c)\ =\ 1}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ i.e.\ compute\ a\ dxd\ matrix\ 'A'\ and\ a\ d\ dimensional\ vector\ 'c'\ as\ the\ center}}
\DoxyCodeLine{00269\ \textcolor{comment}{\ \ \ \ of\ the\ ellipse:}}
\DoxyCodeLine{00270\ \textcolor{comment}{}}
\DoxyCodeLine{00271\ \textcolor{comment}{\ \ \ \ A\ =\ (1/d)\ *\ inv(P\ *\ diag(u)\ *\ P'\ -\/\ (P\ *\ u)*(P*u)'\ )}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ c\ =\ P*u}}
\DoxyCodeLine{00273\ \textcolor{comment}{}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ In\ fact,\ we\ only\ need\ inv(A)\ =\ d\ *\ (\ P\ *\ diag(u)\ *\ P'\ -\/\ (P\ *\ u)*(P*u)'\ )}}
\DoxyCodeLine{00275\ \textcolor{comment}{\ \ \ \ \ \ \ \ =========================================================================================\ */}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ Compute\ c\ =\ P*U}}
\DoxyCodeLine{00278\ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0.0;}
\DoxyCodeLine{00279\ \ \ \ \ dgemv\_(\&NoTrans,\ \&d,\ \&N,\ \&alpha,\ P,\ \&d,\ u,\ \&inc,\ \&beta,\ c,\ \&inc);}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{//\ Compute\ inv(A)\ =\ d\ *\ (\ P\ *\ diag(u)\ *\ P'\ -\/\ (P\ *\ u)*(P*u)'\ )}}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ d;\ i++)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ d;\ j++)\ \{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ sum\ =\ 0.0;}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ N;\ k++)\ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ P[i+k*d]*u[k]*P[j+k*d];}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ A[i+j*d]\ =\ sum;}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00290\ \ \ \ \ \}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ alpha\ =\ -\/1.0;\ beta\ =\ 1.0;}
\DoxyCodeLine{00293\ \ \ \ \ dgemm\_(\&NoTrans,\ \&Trans,\ \&d,\ \&d,\ \&one,\ \&alpha,\ c,\ \&d,\ c,\ \&d,\ \&beta,\ A,\ \&d);}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ alpha\ =\ d;\ }
\DoxyCodeLine{00296\ \ \ \ \ dscal\_(\&dd,\ \&alpha,\ A,\ \&inc);}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{comment}{//\ Clean\ up}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keyword}{delete}\ []\ P;\ \textcolor{keyword}{delete}\ []\ Q;\ \textcolor{keyword}{delete}\ []\ v;\ \textcolor{keyword}{delete}\ []\ w;\ \textcolor{keyword}{delete}\ []\ WORK;\ \textcolor{keyword}{delete}\ []\ IPIV;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \}}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00304\ \textcolor{comment}{\ \ \ Ellipse2D}}
\DoxyCodeLine{00305\ \textcolor{comment}{}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ \ \ Given\ the\ matrix\ representation\ A\ of\ 2D\ ellipse\ and\ its\ center\ c}}
\DoxyCodeLine{00307\ \textcolor{comment}{\ \ \ \ \ \ \ \ (x-\/c)'\ *\ A\ *\ (x-\/c)\ =\ 1}}
\DoxyCodeLine{00308\ \textcolor{comment}{\ \ \ compute\ its\ major\ a\ and\ minor\ axis\ b,\ as\ well\ as\ a\ discrete\ representation}}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ of\ the\ ellipse\ over\ 100\ points}}
\DoxyCodeLine{00310\ \textcolor{comment}{}}
\DoxyCodeLine{00311\ \textcolor{comment}{\ \ \ inputs:}}
\DoxyCodeLine{00312\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00313\ \textcolor{comment}{\ \ \ A\ \ \ :\ (d\ x\ d)\ dimensional\ matrix\ (in\ fact,\ A\string^\{-\/1\}}}
\DoxyCodeLine{00314\ \textcolor{comment}{\ \ \ c\ \ \ :\ center\ of\ ellipse}}
\DoxyCodeLine{00315\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00316\ \textcolor{comment}{\ \ \ outputs:}}
\DoxyCodeLine{00317\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00318\ \textcolor{comment}{\ \ \ a\ \ \ :\ size\ along\ major\ axis\ of\ the\ ellipse}}
\DoxyCodeLine{00319\ \textcolor{comment}{\ \ \ b\ \ \ :\ size\ along\ minor\ axis\ of\ the\ ellipse}}
\DoxyCodeLine{00320\ \textcolor{comment}{\ \ \ ellipse:\ discrete\ representation\ of\ the\ ellipse\ over\ 100\ points}}
\DoxyCodeLine{00321\ \textcolor{comment}{}}
\DoxyCodeLine{00322\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \textcolor{keywordtype}{void}\ Ellipse::Ellipse2D(\textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *c,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b,\ \textcolor{keywordtype}{double}\ *ellipse)}
\DoxyCodeLine{00325\ \ \ \{}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{comment}{//\ Diagonalize\ matrix\ inv(A)\ }}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 2;}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordtype}{double}\ *w\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d];}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordtype}{int}\ lwork\ =\ 2*d*d+6*d+1;\ \textcolor{keywordtype}{double}\ *WORK\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[lwork];}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordtype}{int}\ liwork\ =\ 5*d+3;\ \textcolor{keywordtype}{int}\ *IWORK\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[liwork];}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordtype}{char}\ JOBZ=\textcolor{charliteral}{'V'};\ \textcolor{keywordtype}{char}\ UPLO=\textcolor{charliteral}{'U'};}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{int}\ info;}
\DoxyCodeLine{00336\ \ \ \ \ dsyevd\_(\&JOBZ,\ \&UPLO,\ \&d,\ A,\ \&d,\ w,\ WORK,\ \&lwork,\ IWORK,\ \&liwork,\ \&info);}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{comment}{//\ Major\ and\ Minor\ axis\ are\ the\ square\ roots\ of\ the\ eigenvalues}}
\DoxyCodeLine{00339\ \ \ \ \ *a\ =\ std::sqrt(w[1]);}
\DoxyCodeLine{00340\ \ \ \ \ *b\ =\ std::sqrt(w[0]);}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{comment}{//\ Orientation\ of\ the\ ellipse\ defined\ from\ the\ eigenvector\ associated\ with\ major\ axis}}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordtype}{int}\ inc\ =\ 1;}
\DoxyCodeLine{00344\ \ \ \ \ dcopy\_(\&d,\ \&A[d],\ \&inc,\ w,\ \&inc);}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordtype}{double}\ ang\ =\ std::atan2(w[1],w[0]);}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{comment}{//\ Compute\ discrete\ represention\ of\ ellipse\ over\ 100\ points}}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keywordtype}{int}\ ntime\ =\ 100;}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordtype}{double}\ *t\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[ntime];}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordtype}{double}\ step\ =\ 2*M\_PI/(ntime-\/1);}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ntime;\ i++)\ t[i]\ =\ -\/M\_PI\ +\ i*step;}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordtype}{double}\ x1,\ x2;}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ntime;\ i++)\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ x1\ =\ (*a)*std::cos(t[i]);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ x2\ =\ (*b)*std::sin(t[i]);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ ellipse[2*i]\ =\ std::cos(ang)*x1\ -\/\ std::sin(ang)*x2\ +\ c[0];}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ ellipse[2*i+1]\ =\ std::sin(ang)*x1\ +\ std::cos(ang)*x2\ +\ c[1];}
\DoxyCodeLine{00360\ \ \ \ \ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{comment}{//\ Clean\ up}}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keyword}{delete}\ []\ WORK;\ \textcolor{keyword}{delete}\ []\ IWORK;\ \textcolor{keyword}{delete}\ []\ t;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00368\ \textcolor{comment}{\ \ \ MaxVolEllipse}}
\DoxyCodeLine{00369\ \textcolor{comment}{}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ \ Finds\ the\ maximum\ volume\ inclosing\ ellipsoid\ of\ a\ convex\ polygon.}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ As\ the\ input\ is\ a\ general\ polygon,\ first\ computes\ the\ convex\ hull\ of\ that\ polygon}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ The\ following\ optimization\ problem\ is\ solved:\ }}
\DoxyCodeLine{00373\ \textcolor{comment}{}}
\DoxyCodeLine{00374\ \textcolor{comment}{\ \ \ Find\ the\ maximum\ volume\ ellipsoid}}
\DoxyCodeLine{00375\ \textcolor{comment}{\ \ \ \ \ \ \ \{v:\ \ v\ =\ x\ +\ Es,\ ||s||\ <=\ 1\}}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ \ \ inscribing\ a\ full-\/dimensional\ polytope}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \{v:\ \ Av\ <=\ b\}}}
\DoxyCodeLine{00378\ \textcolor{comment}{}}
\DoxyCodeLine{00379\ \textcolor{comment}{\ \ \ inputs:}}
\DoxyCodeLine{00380\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00381\ \textcolor{comment}{\ \ \ P\ \ \ :\ (d\ x\ N)\ dimensional\ matrix\ containing\ N\ points\ in\ R\string^d.}}
\DoxyCodeLine{00382\ \textcolor{comment}{\ \ \ tol\ :\ error\ in\ the\ solution\ with\ respect\ to\ the\ optimal\ value.}}
\DoxyCodeLine{00383\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00384\ \textcolor{comment}{\ \ \ outputs:}}
\DoxyCodeLine{00385\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00386\ \textcolor{comment}{\ \ \ E\ \ \ \ \ \ \ \ \ \ \ \ :\ matrix\ representing\ ellipse\ (in\ fact,\ E*E')}}
\DoxyCodeLine{00387\ \textcolor{comment}{\ \ \ c\ \ \ \ \ \ \ \ \ \ \ \ :\ center\ of\ ellipse}}
\DoxyCodeLine{00388\ \textcolor{comment}{}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ \ \ Reference:}}
\DoxyCodeLine{00390\ \textcolor{comment}{\ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00391\ \textcolor{comment}{\ \ \ Implementation\ based\ on:}}
\DoxyCodeLine{00392\ \textcolor{comment}{}}
\DoxyCodeLine{00393\ \textcolor{comment}{\ \ \ \ \ Yin\ Zhang\ and\ Liyan\ Gao.\ On\ Numerical\ Solution\ of\ the\ Maximum\ Volume\ Ellipsoid\ Problem.\ }}
\DoxyCodeLine{00394\ \textcolor{comment}{\ \ \ \ SIAM\ Journal\ on\ Optimization,\ Vol.14,\ No.1,\ pp.\ 53-\/76,\ 2003.}}
\DoxyCodeLine{00395\ \textcolor{comment}{}}
\DoxyCodeLine{00396\ \textcolor{comment}{\ \ \ \ and\ corresponding\ MATLAB\ code\ available\ at:}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ \ \ \ https://www.caam.rice.edu/\string~zhang/mve/index.html}}
\DoxyCodeLine{00398\ \textcolor{comment}{}}
\DoxyCodeLine{00399\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \textcolor{keywordtype}{void}\ Ellipse::MaxVolEllipse(\textcolor{keywordtype}{double}\ *P,\ \textcolor{keywordtype}{int}\ N,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *E2,\ \textcolor{keywordtype}{double}\ *x,\ \textcolor{keywordtype}{double}\ tol)}
\DoxyCodeLine{00402\ \ \ \{}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \textcolor{comment}{//\ parameters}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordtype}{int}\ maxiter\ =\ 50;}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keywordtype}{double}\ minmu\ =\ 1.e-\/8;}
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{keywordtype}{double}\ tau0\ =\ 0.75;}
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{keywordtype}{int}\ iprint\ =\ 0;}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ Build\ convex\ hull\ of\ the\ polygon\ defined\ by\ P}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ std::vector<Vector2D>\ CH;}
\DoxyCodeLine{00413\ \ \ \ \ std::vector<Vector2D>\ Poly;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ i++)\ \{}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ Vector2D\ v(P[2*i],\ P[2*i+1]);}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ Poly.push\_back(v);}
\DoxyCodeLine{00418\ \ \ \ \ \}}
\DoxyCodeLine{00419\ \ \ \ \ convexhull.ConvexPoly(Poly,\ CH);}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordtype}{int}\ nCH\ =\ CH.size();}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{comment}{//\ Center\ of\ gravity\ of\ convex\ hull}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordtype}{double}\ x0[2];}
\DoxyCodeLine{00425\ \ \ \ \ x0[0]\ =\ 0;\ x0[1]\ =\ 0;}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ nCH-\/1;\ i++)\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ x0[0]\ +=\ CH[i][0];}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ x0[1]\ +=\ CH[i][1];}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ \ \ \ \ x0[0]\ /=\ (nCH-\/1);\ x0[1]\ /=\ (nCH-\/1);}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{comment}{//\ Generate\ affine\ constraints\ A\ and\ b}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ nCH-\/1;\ \textcolor{keywordtype}{int}\ nn=n*n;}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordtype}{double}\ *A\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n*d];}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordtype}{double}\ *b\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordtype}{double}\ *bmAx0\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keywordtype}{double}\ r,\ s,\ t,\ u,\ val;}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ r\ =\ CH[i+1][0]-\/CH[i][0];\ s\ =\ CH[i+1][1]-\/CH[i][1];}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ val\ =\ std::sqrt(r*r+s*s);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ t\ =\ r;\ r\ =\ -\/s/val;\ s\ =\ t/val;\ }
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ t\ =\ CH[i+1][0]+CH[i][0];}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ u\ =\ CH[i+1][1]+CH[i][1];}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ A[i]\ =\ r;\ A[i+n]\ =\ s;}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ b[i]\ =\ 0.5*(r*t+s*u);}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ val\ =\ r*x0[0]+s*x0[1]\ -\/b[i];}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(val\ >\ 0)\ \{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ A[i]\ =\ -\/A[i];\ A[i+n]=-\/A[i+n];\ b[i]\ =\ -\/b[i];}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00451\ \ \ \ \ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordtype}{int}\ inc\ =\ 1;}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordtype}{double}\ alpha\ =\ -\/1;\ \textcolor{keywordtype}{double}\ beta\ =\ 1;}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordtype}{char}\ NoTrans\ =\ \textcolor{charliteral}{'N'};\ \textcolor{keywordtype}{char}\ Trans\ =\ \textcolor{charliteral}{'T'};}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordtype}{double}\ bnrm\ =\ dnrm2\_(\&n,\ b,\ \&inc);}
\DoxyCodeLine{00458\ \ \ \ \ dcopy\_(\&n,\ b,\ \&inc,\ bmAx0,\ \&inc);}
\DoxyCodeLine{00459\ \ \ \ \ dgemv\_(\&NoTrans,\ \&n,\ \&d,\ \&alpha,\ A,\ \&n,\ x0,\ \&inc,\ \&beta,\ bmAx0,\ \&inc);}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{comment}{//\ Check\ that\ center\ of\ gravity,\ Xmean,\ is\ inside\ the\ convex\ polygon}}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{comment}{//\ Should\ never\ be\ a\ problem...}}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(bmAx0[i]\ <=\ 0)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Problem\ in\ MaxVolEllipse!"{}}\ <<\ std::endl;}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Center\ of\ gravity\ not\ in\ convex\ hull...."{}}\ <<\ std::endl;}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00470\ \ \ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ d;\ k++)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ A[i+k*n]\ /=\ bmAx0[i];}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ b[i]\ =\ 1.0;}
\DoxyCodeLine{00477\ \ \ \ \ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordtype}{double}\ *y\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *z\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{keywordtype}{double}\ *dx\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d];\ \textcolor{keywordtype}{double}\ *dy\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *dz\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordtype}{double}\ *yz\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *yh\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *bmAx\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \ \ memset(x,\ 0,\ d*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ y[i]\ =\ 1.0;}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ bmAx[i]\ =\ 1.0;}
\DoxyCodeLine{00487\ \ \ \ \ \}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{keywordtype}{double}\ res\ =\ 1;}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordtype}{double}\ sum,\ gap,\ rmu;}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ei\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d*d];}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordtype}{double}\ *W\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n*d];}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordtype}{double}\ *Q\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n*n];\ \textcolor{keywordtype}{double}\ *G\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n*n];}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keywordtype}{double}\ *h\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *Adx\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keywordtype}{double}\ *R1\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d];\ \textcolor{keywordtype}{double}\ *R2\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];\ \textcolor{keywordtype}{double}\ *R3\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[n];}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keywordtype}{int}\ *IPIV\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[n];}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{keywordtype}{int}\ info;}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{keywordtype}{double}\ r1,\ r2,\ r3,\ objval;}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keywordtype}{double}\ ax,\ ay,\ az,\ tau,\ astep;}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordflow}{if}(iprint==1)\ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}========================================================="{}}\ <<\ std::endl;}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\ \ Residuals:\ \ \ \ \ Primal\ \ \ \ Dual\ \ \ \ Duality\ \ \ \ \ log(detE)\ "{}}\ <<\ std::endl;}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}========================================================="{}}\ <<\ std::endl;}
\DoxyCodeLine{00507\ \ \ \ \ \}}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{comment}{//\ Start\ iterations}}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ iter\ =\ 0;\ iter\ <\ maxiter;\ iter++)\ \{}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(iter\ >\ 0)\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ =\ -\/astep;}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ daxpy\_(\&n,\ \&alpha,\ Adx,\ \&inc,\ bmAx,\ \&inc);}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ d;\ i++)\ \{}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ d;\ j++)\ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum\ =\ 0.;}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ n;\ k++)\ \{}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sum+=\ A[k+i*n]*y[k]*A[k+j*n];}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ei[i+d*j]\ =\ sum;}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ matInv2(Ei,\ E2);}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0.0;}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ dgemm\_(\&NoTrans,\ \&NoTrans,\ \&n,\ \&d,\ \&d,\ \&alpha,\ A,\ \&n,\ E2,\ \&d,\ \&beta,\ W,\ \&n);}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ dgemm\_(\&NoTrans,\ \&Trans,\ \&n,\ \&n,\ \&d,\ \&alpha,\ W,\ \&n,\ A,\ \&n,\ \&beta,\ Q,\ \&n);}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ h[i]\ =\ std::sqrt(Q[i+n*i]);}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(iter\ ==\ 0)\ \{}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ bmAx[0]/h[0];\ }
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ n;\ i++)\ t\ =\ std::min(t,\ bmAx[i]/h[i]);}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y[i]\ =\ y[i]/(t*t);}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h[i]\ =\ t*h[i];}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z[i]\ =\ std::max(0.1,\ bmAx[i]-\/h[i]);}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ =\ t*t;}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ dscal\_(\&nn,\ \&alpha,\ Q,\ \&inc);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ sum\ =\ 0.0;}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ yz[i]\ =\ y[i]*z[i];}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ yh[i]\ =\ y[i]*h[i];}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ sum\ +=\ yz[i];}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ gap\ =\ sum/n;}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ rmu\ =\ std::min(0.5,\ gap)*gap;}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ rmu\ =\ std::max(rmu,\ minmu);}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ alpha\ =\ -\/1.0;\ beta\ =\ 0.0;}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ dgemv\_(\&Trans,\ \&n,\ \&d,\ \&alpha,\ A,\ \&n,\ yh,\ \&inc,\ \&beta,\ R1,\ \&inc);}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ r1\ =\ std::max(std::abs(R1[0]),\ std::abs(R1[1]));}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ r2\ =\ 0;\ r3\ =\ 0;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ R2[i]\ =\ bmAx[i]\ -\/\ h[i]\ -\/\ z[i];}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ R3[i]\ =\ rmu\ -\/\ yz[i];}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ r2\ =\ std::max(r2,\ std::abs(R2[i]));}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ r3\ =\ std::max(r3,\ std::abs(R3[i]));}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ res\ =\ std::max(r1,\ std::max(r2,\ r3));}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ val\ =\ E2[0]*E2[3]-\/E2[1]*E2[2];}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ objval\ =\ std::log(val)/2;}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(iprint==1)\ \{}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}iter\ =\ "{}}\ <<\ iter\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ \ \ "{}}\ <<\ r2\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ r1\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ r3\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ objval\ <<\ std::endl;}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\ res\ <\ tol*(1+bnrm)\ \&\&\ rmu\ <=\ minmu)\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ d;\ i++)\ x[i]\ +=\ x0[i];}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ n;\ j++)\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G[i+n*j]\ =\ y[i]*y[j]*Q[i+j*n]*Q[j+i*n];}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ G[i+i*n]\ +=\ std::max(1.e-\/12,\ 2*yh[i]*z[i]);}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ d;\ j++)\ \{}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i+j*n]\ =\ y[i]*(h[i]+z[i])*A[i+j*n];}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ dgetrf\_(\&n,\ \&n,\ G,\ \&n,\ IPIV,\ \&info);}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ dgetrs\_(\&NoTrans,\ \&n,\ \&d,\ G,\ \&n,\ IPIV,\ W,\ \&n,\ \&info);}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ d;\ j++)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ W[i+j*n]\ =\ 2*yh[i]*W[i+j*n]\ -\/\ y[i]*A[i+j*n];}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ \ R3[i]\ =\ R3[i]/y[i];}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \ \ R2[i]\ =\ R2[i]\ -\/\ R3[i];}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0.0;}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ dgemm\_(\&Trans,\ \&NoTrans,\ \&d,\ \&d,\ \&n,\ \&alpha,\ W,\ \&n,\ A,\ \&n,\ \&beta,\ Ei,\ \&d);}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ dgemv\_(\&Trans,\ \&n,\ \&d,\ \&alpha,\ W,\ \&n,\ R2,\ \&inc,\ \&beta,\ h,\ \&inc);}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ daxpy\_(\&d,\ \&alpha,\ R1,\ \&inc,\ h,\ \&inc);}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ matInv2(Ei,\ E2);}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ dgemv\_(\&NoTrans,\ \&d,\ \&d,\ \&alpha,\ E2,\ \&d,\ h,\ \&inc,\ \&beta,\ dx,\ \&inc);}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ dgemv\_(\&NoTrans,\ \&n,\ \&d,\ \&alpha,\ A,\ \&n,\ dx,\ \&inc,\ \&beta,\ Adx,\ \&inc);}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ h[i]\ =\ 2*yh[i]*(Adx[i]-\/R2[i]);}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ dgetrs\_(\&NoTrans,\ \&n,\ \&inc,\ G,\ \&n,\ IPIV,\ h,\ \&n,\ \&info);}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ dy[i]\ =\ y[i]*h[i];}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ dz[i]\ =\ R3[i]\ -\/\ z[i]*h[i];}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ ax\ =\ Adx[0]/bmAx[0];\ ay\ =\ h[0];\ az\ =\ dz[0]/z[0];}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ ax\ =\ std::min(ax,\ Adx[i]/bmAx[i]);\ ay\ =\ std::min(ay,\ h[i]);\ az\ =\ std::min(az,\ dz[i]/z[i]);}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ ax\ =\ std::min(-\/0.5,\ ax);\ ay\ =\ std::min(-\/0.5,\ ay);\ az\ =\ std::min(-\/0.5,\ az);}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ ax\ =\ -\/1/ax;\ ay\ =\ -\/1/ay;\ az\ =\ -\/1/az;}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ tau\ =\ std::max(tau0,\ 1-\/res);}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ astep\ =\ \ std::min(ax,\ std::min(ay,\ az));\ astep\ =\ tau*std::min(1.,\ astep);}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ daxpy\_(\&d,\ \&astep,\ dx,\ \&inc,\ x,\ \&inc);}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ daxpy\_(\&n,\ \&astep,\ dy,\ \&inc,\ y,\ \&inc);}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ daxpy\_(\&n,\ \&astep,\ dz,\ \&inc,\ z,\ \&inc);}
\DoxyCodeLine{00634\ \ \ \ \ \}}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{if}(iprint==1)\ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}========================================================="{}}\ <<\ std::endl;}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ std::cout\ <<\ std::endl;}
\DoxyCodeLine{00640\ \ \ \ \ \}}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \ \}}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00645\ \textcolor{comment}{\ \ \ Computes\ the\ inverse\ of\ a\ 2x2\ matrix}}
\DoxyCodeLine{00646\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \ \textcolor{keywordtype}{void}\ Ellipse::matInv2(\textcolor{keywordtype}{double}\ *A,\ \textcolor{keywordtype}{double}\ *Ainv)}
\DoxyCodeLine{00649\ \ \ \ \{}
\DoxyCodeLine{00650\ \ \ \ \ \textcolor{keywordtype}{double}\ det\ =\ A[0]*A[3]\ -\/\ A[2]*A[1];}
\DoxyCodeLine{00651\ \ \ \ \ det\ =\ 1.0/det;}
\DoxyCodeLine{00652\ \ \ \ \ Ainv[0]\ =\ A[3]*det;\ Ainv[1]\ =\ -\/A[1]*det;}
\DoxyCodeLine{00653\ \ \ \ \ Ainv[2]\ =\ -\/A[2]*det;\ Ainv[3]\ =\ A[0]*det;}
\DoxyCodeLine{00654\ \ \ \ \}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00657\ \textcolor{comment}{\ \ \ Computes\ the\ least\ square\ fitting\ helix}}
\DoxyCodeLine{00658\ \textcolor{comment}{}}
\DoxyCodeLine{00659\ \textcolor{comment}{\ \ \ inputs:}}
\DoxyCodeLine{00660\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00661\ \textcolor{comment}{\ \ \ P\ \ \ :\ (d\ x\ N)\ dimensional\ matrix\ containing\ N\ points\ in\ R\string^d.}}
\DoxyCodeLine{00662\ \textcolor{comment}{\ \ }}
\DoxyCodeLine{00663\ \textcolor{comment}{\ \ \ outputs:}}
\DoxyCodeLine{00664\ \textcolor{comment}{\ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00665\ \textcolor{comment}{\ \ \ a\ \ :\ major\ axis\ of\ the\ ellipse}}
\DoxyCodeLine{00666\ \textcolor{comment}{\ \ \ b\ \ :\ minor\ axis\ of\ the\ ellipse}}
\DoxyCodeLine{00667\ \textcolor{comment}{}}
\DoxyCodeLine{00668\ \textcolor{comment}{\ \ \ Implementation\ based\ on:}}
\DoxyCodeLine{00669\ \textcolor{comment}{}}
\DoxyCodeLine{00670\ \textcolor{comment}{\ \ \ \ A.\ W.\ Fitzgibbon,\ M.\ Pilu\ and\ R.\ B.\ Fisher,\ "{}Direct\ least\ squares\ fitting\ of\ ellipses,"{}\ }}
\DoxyCodeLine{00671\ \textcolor{comment}{\ \ \ \ Proceedings\ of\ 13th\ International\ Conference\ on\ Pattern\ Recognition,\ 1996,\ pp.\ 253-\/257\ vol.1,\ }}
\DoxyCodeLine{00672\ \textcolor{comment}{\ \ \ \ doi:\ 10.1109/ICPR.1996.546029.}}
\DoxyCodeLine{00673\ \textcolor{comment}{}}
\DoxyCodeLine{00674\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00675\ }
\DoxyCodeLine{00676\ \ \ \ \textcolor{keywordtype}{void}\ Ellipse::lsqEllipse(\textcolor{keywordtype}{double}\ *P,\ \textcolor{keywordtype}{int}\ N,\ \textcolor{keywordtype}{int}\ d,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{00677\ \ \ \ \{}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordtype}{double}\ *Dmat\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[6*N];}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{keywordtype}{double}\ *Smat\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[6*6];}
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keywordtype}{double}\ *Cmat\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[6*6];}
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{keywordtype}{double}\ *VR\ \ \ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[6*6];}
\DoxyCodeLine{00683\ \ \ \ \ \textcolor{keywordtype}{double}\ *VL\ \ \ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[6*6];}
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{keywordtype}{int}\ *IPIV\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[6];}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordtype}{int}\ lwork\ =\ 200;}
\DoxyCodeLine{00686\ \ \ \ \ \textcolor{keywordtype}{double}\ *WORK\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[lwork];}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{comment}{//\ Build\ design\ matrix\ (size\ 6xN)}}
\DoxyCodeLine{00689\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ N;\ i++)\ \{}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 0*N]\ =\ P[2*i]*P[2*i];}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 1*N]\ =\ P[2*i]*P[2*i+1];}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 2*N]\ =\ P[2*i+1]*P[2*i+1];}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 3*N]\ =\ P[2*i];}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 4*N]\ =\ P[2*i+1];}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ Dmat[i\ +\ 5*N]\ =\ 1.;}
\DoxyCodeLine{00696\ \ \ \ \ \}}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{comment}{//\ Build\ scatter\ matrix\ Smat\ =\ Dmat\string^T\ Dmat\ (size\ 6x6)}}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{keywordtype}{int}\ info;}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{keywordtype}{int}\ six\ =\ 6;}
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keywordtype}{char}\ NoTrans\ =\ \textcolor{charliteral}{'N'};\ \textcolor{keywordtype}{char}\ Trans\ =\ \textcolor{charliteral}{'T'};}
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{keywordtype}{double}\ alpha,\ beta;}
\DoxyCodeLine{00703\ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0.;}
\DoxyCodeLine{00704\ \ \ \ \ dgemm\_(\&Trans,\ \&NoTrans,\ \&six,\ \&six,\ \&N,\ \&alpha,\ Dmat,\ \&N,\ Dmat,\ \&N,\ \&beta,\ Smat,\ \&six);}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \ \ \textcolor{comment}{//\ Build\ constraint\ matrix\ Cmat\ (size\ 6x6)}}
\DoxyCodeLine{00707\ \ \ \ \ memset(Cmat,\ 0,\ 6*6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00708\ \ \ \ \ Cmat[12]\ =\ 2;\ Cmat[7]\ =\ -\/1;\ Cmat[2]=2;}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{comment}{//\ Build\ eigen\ problem:\ matrix\ stored\ E\ =\ inv(Smat)\ *\ C\ stored\ in\ Dmat}}
\DoxyCodeLine{00711\ \ \ \ \ dgetrf\_(\&six,\ \&six,\ Smat,\ \&six,\ IPIV,\ \&info);}
\DoxyCodeLine{00712\ \ \ \ \ dgetri\_(\&six,\ Smat,\ \&six,\ IPIV,\ WORK,\ \&lwork,\ \&info);}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \ \ alpha\ =\ 1.0;\ beta\ =\ 0.;}
\DoxyCodeLine{00715\ \ \ \ \ dgemm\_(\&NoTrans,\ \&NoTrans,\ \&six,\ \&six,\ \&six,\ \&alpha,\ Smat,\ \&six,\ Cmat,\ \&six,\ \&beta,\ Dmat,\ \&six);}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{comment}{//\ Solve\ general\ eigen\ problem;\ we\ only\ need\ the\ right\ eigenvectors}}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordtype}{char}\ JOBVL=\textcolor{charliteral}{'N'};\ \textcolor{keywordtype}{char}\ JOBVR=\textcolor{charliteral}{'V'};}
\DoxyCodeLine{00719\ \ \ \ \ dgeev\_(\&JOBVL,\ \&JOBVR,\ \&six,\ Dmat,\ \&six,\ Cmat,\ Smat,\ VL,\ \&six,\ VR,\ \&six,\ WORK,\ \&lwork,\ \&info);}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ positive\ eigenvalue}}
\DoxyCodeLine{00722\ \ \ \ \ \textcolor{keywordtype}{int}\ idx\ =\ -\/1;}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 6;\ i++)\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(Cmat[i]\ >\ 0)\ \{}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ idx\ =\ i;}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00728\ \ \ \ \ \}}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{comment}{//\ Find\ coefficient\ of\ ellipse:\ A\ X\string^2\ +\ B\ XY\ C\ Y\string^2\ +\ D\ X\ +\ E\ Y\ +\ F}}
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{comment}{//\ as\ the\ (right)\ eigenvector\ corresponding\ to\ the\ positive\ eigenvalue}}
\DoxyCodeLine{00732\ \ \ \ \ \textcolor{keywordtype}{double}\ A\ =\ VR[0+6*idx];\ \textcolor{keywordtype}{double}\ B\ =\ VR[1+6*idx];\ \textcolor{keywordtype}{double}\ C\ =\ VR[2+6*idx];}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{keywordtype}{double}\ D\ =\ VR[3+6*idx];\ \textcolor{keywordtype}{double}\ E\ =\ VR[4+6*idx];\ \textcolor{keywordtype}{double}\ F\ =\ VR[5+6*idx];}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{comment}{//\ Compute\ major\ axis\ (a)\ and\ minor\ axis\ (b)\ for\ the\ ellipse}}
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{comment}{//\ see:\ https://en.wikipedia.org/wiki/Ellipse}}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordtype}{double}\ den\ =\ B*B\ -\/\ 4*A*C;}
\DoxyCodeLine{00738\ \ \ \ \ \textcolor{keywordtype}{double}\ val1\ =\ (A-\/C)*(A-\/C)\ +\ B*B;}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordtype}{double}\ valp\ =\ A+C\ +\ std::sqrt(val1);}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordtype}{double}\ valn\ =\ A+C\ -\/\ std::sqrt(val1);}
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordtype}{double}\ val2\ =\ A*E*E\ +\ C*D*D\ -\/\ B*D*E\ +\ (B*B-\/4*A*C)*F;}
\DoxyCodeLine{00742\ \ \ \ \ \textcolor{keywordtype}{double}\ nump\ =\ std::sqrt(2*val2*valp);}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordtype}{double}\ numn\ =\ std::sqrt(2*val2*valn);}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \ \ \ \ val1\ =\ -\/nump/den;}
\DoxyCodeLine{00746\ \ \ \ \ valp\ =\ -\/numn/den;}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \ \ *a\ =\ std::max(val1,valp);}
\DoxyCodeLine{00749\ \ \ \ \ *b\ =\ std::min(val1,valp);}
\DoxyCodeLine{00750\ }
\DoxyCodeLine{00751\ \ \ \ \ \textcolor{comment}{//\ Clean\ up}}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keyword}{delete}\ []\ Dmat;\ \textcolor{keyword}{delete}\ []\ Smat;\ \textcolor{keyword}{delete}\ []\ Cmat;\ \textcolor{keyword}{delete}\ []\ VL;\ \textcolor{keyword}{delete}\ []\ VR;\ \textcolor{keyword}{delete}\ []\ WORK;}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \ \ \ \}}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00757\ \textcolor{comment}{\ \ \ Compute\ largest\ enclosed\ ellipse\ for\ a\ polygon}}
\DoxyCodeLine{00758\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \ \textcolor{keywordtype}{void}\ Ellipse::EllipseMax(Polygon\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{00761\ \ \ \ \{}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{comment}{//\ Define\ point\ sets\ P}}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ curve.vertices.size();}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordtype}{double}\ *P\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[2*n];}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ P[2*i+0]\ =\ curve.vertices[i].position[0];}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ P[2*i+1]\ =\ curve.vertices[i].position[1];}
\DoxyCodeLine{00772\ \ \ \ \ \}}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 2;}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordtype}{double}\ *A\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d*d];}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordtype}{double}\ *c\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d];}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keywordtype}{double}\ *ellipse\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[1000];}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{comment}{//\ Find\ maximum\ volume\ enclosed\ ellipse\ for\ curve\ 1}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordtype}{double}\ tol\ =\ 1.e-\/6;}
\DoxyCodeLine{00781\ \ \ \ \ MaxVolEllipse(P,\ n,\ d,\ A,\ c,\ tol);}
\DoxyCodeLine{00782\ \ \ \ \ Ellipse2D(A,\ c,\ a,\ b,\ ellipse);}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keyword}{delete}\ []\ P;\ \textcolor{keyword}{delete}\ []\ A;\ \textcolor{keyword}{delete}\ []\ c;\ \textcolor{keyword}{delete}\ []\ ellipse;}
\DoxyCodeLine{00785\ \ \ \ \}}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00788\ \textcolor{comment}{\ \ \ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ largest\ enclosed\ ellipse}}
\DoxyCodeLine{00789\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \textcolor{keywordtype}{double}\ Ellipse::dEllipseMax(Polygon\&\ curve1,\ Polygon\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2)}
\DoxyCodeLine{00792\ \ \ \ \{}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \ \ EllipseMax(curve1,\ a1,\ b1);}
\DoxyCodeLine{00795\ \ \ \ \ EllipseMax(curve2,\ a2,\ b2);}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ \textcolor{comment}{//\ L1\ norm\ of\ the\ difference\ of\ the\ aspect\ ratios}}
\DoxyCodeLine{00798\ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ std::abs(\ (*a1)/(*b1)\ -\/\ (*a2)/(*b2)\ );}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keywordflow}{return}\ dist;}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \}}
\DoxyCodeLine{00803\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00804\ \textcolor{comment}{\ \ \ Compute\ smallest\ enclosing\ ellipse\ for\ a\ polygon}}
\DoxyCodeLine{00805\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \ \textcolor{keywordtype}{void}\ Ellipse::EllipseMin(Polygon\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{00808\ \ \ \ \{}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{comment}{//\ Define\ point\ sets\ P}}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ curve.vertices.size();}
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \ \ \textcolor{keywordtype}{double}\ *P\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[2*n];}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ P[2*i+0]\ =\ curve.vertices[i].position[0];}
\DoxyCodeLine{00818\ \ \ \ \ \ \ \ \ P[2*i+1]\ =\ curve.vertices[i].position[1];}
\DoxyCodeLine{00819\ \ \ \ \ \}}
\DoxyCodeLine{00820\ }
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 2;}
\DoxyCodeLine{00822\ \ \ \ \ \textcolor{keywordtype}{double}\ *A\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d*d];}
\DoxyCodeLine{00823\ \ \ \ \ \textcolor{keywordtype}{double}\ *c\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[d];}
\DoxyCodeLine{00824\ \ \ \ \ \textcolor{keywordtype}{double}\ *ellipse\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[1000];}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{comment}{//\ Find\ minimum\ volume\ enclosing\ ellipse\ for\ curve}}
\DoxyCodeLine{00827\ \ \ \ \ \textcolor{keywordtype}{double}\ tol\ =\ 1.e-\/6;}
\DoxyCodeLine{00828\ \ \ \ \ MinVolEllipse(P,\ n,\ d,\ A,\ c,\ tol);}
\DoxyCodeLine{00829\ \ \ \ \ Ellipse2D(A,\ c,\ a,\ b,\ ellipse);}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{keyword}{delete}\ []\ P;\ \textcolor{keyword}{delete}\ []\ A;\ \textcolor{keyword}{delete}\ []\ c;\ \textcolor{keyword}{delete}\ []\ ellipse;}
\DoxyCodeLine{00832\ \ \ \ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00835\ \textcolor{comment}{\ \ \ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ smallest\ enclosing\ ellipse}}
\DoxyCodeLine{00836\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \ \ \ \textcolor{keywordtype}{double}\ Ellipse::dEllipseMin(Polygon\&\ curve1,\ Polygon\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2)}
\DoxyCodeLine{00839\ \ \ \ \{}
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00841\ \ \ \ \ EllipseMin(curve1,\ a1,\ b1);}
\DoxyCodeLine{00842\ \ \ \ \ EllipseMin(curve2,\ a2,\ b2);}
\DoxyCodeLine{00843\ }
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{comment}{//\ L1\ norm\ of\ the\ difference\ of\ the\ aspect\ ratios}}
\DoxyCodeLine{00845\ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ std::abs(\ (*a1)/(*b1)\ -\/\ (*a2)/(*b2)\ );}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \ \ \textcolor{keywordflow}{return}\ dist;}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \ \ \}}
\DoxyCodeLine{00850\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00851\ \textcolor{comment}{\ \ \ Compute\ least\ square\ fitting\ ellipse\ for\ a\ polygon}}
\DoxyCodeLine{00852\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \ \ \ \textcolor{keywordtype}{void}\ Ellipse::EllipseLSQ(Polygon\&\ curve,\ \textcolor{keywordtype}{double}\ *a,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{00855\ \ \ \ \{}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00857\ \ \ \ \ \textcolor{comment}{//\ Define\ point\ sets\ P}}
\DoxyCodeLine{00858\ }
\DoxyCodeLine{00859\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ curve.vertices.size();}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \ \ \textcolor{keywordtype}{double}\ *P\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{double}[2*n];}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ P[2*i+0]\ =\ curve.vertices[i].position[0];}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ P[2*i+1]\ =\ curve.vertices[i].position[1];}
\DoxyCodeLine{00866\ \ \ \ \ \}}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ 2;}
\DoxyCodeLine{00869\ }
\DoxyCodeLine{00870\ \ \ \ \ \textcolor{comment}{//\ Find\ least\ square\ ellipse\ passing\ through\ Point\ set}}
\DoxyCodeLine{00871\ \ \ \ \ lsqEllipse(P,\ n,\ d,\ a,\ b);}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ \ \ \textcolor{keyword}{delete}\ []\ P;}
\DoxyCodeLine{00874\ }
\DoxyCodeLine{00875\ \ \ \ \}}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \textcolor{comment}{/*\ ===============================================================================================}}
\DoxyCodeLine{00878\ \textcolor{comment}{\ \ \ Compute\ difference\ of\ aspect\ ratio\ between\ 2\ curves\ based\ on\ the\ lsq\ ellipse}}
\DoxyCodeLine{00879\ \textcolor{comment}{\ \ \ ===============================================================================================\ */}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \ \textcolor{keywordtype}{double}\ Ellipse::dEllipseLSQ(Polygon\&\ curve1,\ Polygon\&\ curve2,\ \textcolor{keywordtype}{double}\ *a1,\ \textcolor{keywordtype}{double}\ *b1,\ \textcolor{keywordtype}{double}\ *a2,\ \textcolor{keywordtype}{double}\ *b2)}
\DoxyCodeLine{00882\ \ \ \ \{}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ \ \ \ \ EllipseLSQ(curve1,\ a1,\ b1);}
\DoxyCodeLine{00885\ \ \ \ \ EllipseLSQ(curve2,\ a2,\ b2);}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ \textcolor{comment}{//\ L1\ norm\ of\ the\ difference\ of\ the\ aspect\ ratios}}
\DoxyCodeLine{00888\ \ \ \ \ \textcolor{keywordtype}{double}\ dist\ =\ std::abs(\ (*a1)/(*b1)\ -\/\ (*a2)/(*b2)\ );}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00890\ \ \ \ \ \textcolor{keywordflow}{return}\ dist;}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \ \ \}}
\DoxyCodeLine{00893\ \}\ \textcolor{comment}{//end\ namespace\ correa}}
\DoxyCodeLine{00894\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
