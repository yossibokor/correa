\label{index_top}%
\Hypertarget{index_top}%
 \hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md226}{}\doxysection{Supplying main() yourself}\label{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md226}
{\bfseries{Contents}}~\newline
 Let Catch2 take full control of args and config~\newline
 Amending the Catch2 config~\newline
 Adding your own command line options~\newline
 Version detection~\newline


The easiest way to use Catch2 is to use its own {\ttfamily main} function, and let it handle the command line arguments. This is done by linking against Catch2\+Main library, e.\+g. through the \href{cmake-integration.md\#cmake-targets}{\texttt{ CMake target}}, or pkg-\/config files.

If you want to provide your own {\ttfamily main}, then you should link against the static library (target) only, without the main part. You will then have to write your own {\ttfamily main} and call into Catch2 test runner manually.

Below are some basic recipes on what you can do supplying your own main.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md227}{}\doxysubsection{Let Catch2 take full control of args and config}\label{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md227}
This is useful if you just need to have code that executes before/after Catch2 runs tests.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <catch2/catch\_session.hpp>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main(\ \textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}*\ argv[]\ )\ \{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ your\ setup\ ...}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ result\ =\ \mbox{\hyperlink{class_catch_1_1_session}{Catch::Session}}().run(\ argc,\ argv\ );}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ your\ clean-\/up...}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{\}}

\end{DoxyCode}


{\itshape Note that if you only want to run some set up before tests are run, it might be simpler to use \href{event-listeners.md\#top}{\texttt{ event listeners}} instead.}\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md228}{}\doxysubsection{Amending the Catch2 config}\label{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md228}
If you want Catch2 to process command line arguments, but also want to programmatically change the resulting configuration of Catch2 run, you can do it in two ways\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\ ++}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main(\ \textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}*\ argv[]\ )\ \{}
\DoxyCodeLine{\ \ \mbox{\hyperlink{class_catch_1_1_session}{Catch::Session}}\ session;\ \textcolor{comment}{//\ There\ must\ be\ exactly\ one\ instance}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ writing\ to\ session.configData()\ here\ sets\ defaults}}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ this\ is\ the\ preferred\ way\ to\ set\ them}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ returnCode\ =\ session.applyCommandLine(\ argc,\ argv\ );}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{if}(\ returnCode\ !=\ 0\ )\ \textcolor{comment}{//\ Indicates\ a\ command\ line\ error}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ returnCode;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ writing\ to\ session.configData()\ or\ session.Config()\ here}}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ overrides\ command\ line\ args}}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ only\ do\ this\ if\ you\ know\ you\ need\ to}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ numFailed\ =\ session.run();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ numFailed\ is\ clamped\ to\ 255\ as\ some\ unices\ only\ use\ the\ lower\ 8\ bits.}}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ This\ clamping\ has\ already\ been\ applied,\ so\ just\ return\ it\ here}}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ You\ can\ also\ do\ any\ post\ run\ clean-\/up\ here}}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{return}\ numFailed;}
\DoxyCodeLine{\}}

\end{DoxyCode}


If you want full control of the configuration, don\textquotesingle{}t call {\ttfamily apply\+Command\+Line}.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md229}{}\doxysubsection{Adding your own command line options}\label{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md229}
You can add new command line options to Catch2, by composing the premade CLI parser (called Clara), and add your own options.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main(\ \textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}*\ argv[]\ )\ \{}
\DoxyCodeLine{\ \ \mbox{\hyperlink{class_catch_1_1_session}{Catch::Session}}\ session;\ \textcolor{comment}{//\ There\ must\ be\ exactly\ one\ instance}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ height\ =\ 0;\ \textcolor{comment}{//\ Some\ user\ variable\ you\ want\ to\ be\ able\ to\ set}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ Build\ a\ new\ parser\ on\ top\ of\ Catch2's}}
\DoxyCodeLine{\ \ \textcolor{keyword}{using\ namespace\ }Catch::Clara;}
\DoxyCodeLine{\ \ \textcolor{keyword}{auto}\ cli}
\DoxyCodeLine{\ \ \ \ =\ session.cli()\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ Catch2's\ command\ line\ parser}}
\DoxyCodeLine{\ \ \ \ |\ \mbox{\hyperlink{class_catch_1_1_clara_1_1_opt}{Opt}}(\ height,\ \textcolor{stringliteral}{"{}height"{}}\ )\ \textcolor{comment}{//\ bind\ variable\ to\ a\ new\ option,\ with\ a\ hint\ string}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}-\/g"{}}][\textcolor{stringliteral}{"{}-\/-\/height"{}}]\ \ \ \ \textcolor{comment}{//\ the\ option\ names\ it\ will\ respond\ to}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}how\ high?"{}});\ \ \ \ \ \ \ \ \textcolor{comment}{//\ description\ string\ for\ the\ help\ output}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ Now\ pass\ the\ new\ composite\ back\ to\ Catch2\ so\ it\ uses\ that}}
\DoxyCodeLine{\ \ session.cli(\ cli\ );}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ Let\ Catch2\ (using\ Clara)\ parse\ the\ command\ line}}
\DoxyCodeLine{\ \ \textcolor{keywordtype}{int}\ returnCode\ =\ session.applyCommandLine(\ argc,\ argv\ );}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{if}(\ returnCode\ !=\ 0\ )\ \textcolor{comment}{//\ Indicates\ a\ command\ line\ error}}
\DoxyCodeLine{\ \ \ \ \ \ \textcolor{keywordflow}{return}\ returnCode;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{comment}{//\ if\ set\ on\ the\ command\ line\ then\ 'height'\ is\ now\ set\ at\ this\ point}}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{if}(\ height\ >\ 0\ )}
\DoxyCodeLine{\ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}height:\ "{}}\ <<\ height\ <<\ std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{return}\ session.run();}
\DoxyCodeLine{\}}

\end{DoxyCode}


See the \href{https://github.com/catchorg/Clara/blob/master/README.md}{\texttt{ Clara documentation}} for more details on how to use the Clara parser.\hypertarget{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md230}{}\doxysubsection{Version detection}\label{md_ext_2hera_2extern_2_catch2_2docs_2own-main_autotoc_md230}
Catch2 provides a triplet of macros providing the header\textquotesingle{}s version,


\begin{DoxyItemize}
\item {\ttfamily CATCH\+\_\+\+VERSION\+\_\+\+MAJOR}
\item {\ttfamily CATCH\+\_\+\+VERSION\+\_\+\+MINOR}
\item {\ttfamily CATCH\+\_\+\+VERSION\+\_\+\+PATCH}
\end{DoxyItemize}

these macros expand into a single number, that corresponds to the appropriate part of the version. As an example, given single header version v2.\+3.\+4, the macros would expand into {\ttfamily 2}, {\ttfamily 3}, and {\ttfamily 4} respectively.

\DoxyHorRuler{0}


\href{Readme.md\#top}{\texttt{ Home}} 